{"version":3,"sources":["components/form_utils.jsx","constraints/loginConstraints.js","constraints/signupConstraints.js","actions/actionTypes.js","actions/userActions.js","utils/communication.js","constants.js","utils/password.js","components/login.jsx","components/dialog_utils.jsx","components/error_page.jsx","components/loading_page.jsx","actions/deviceActions.js","actions/ruleActions.js","components/dashboard.jsx","constraints/deviceConstraints.js","components/device_form.jsx","constraints/ruleConstraints.js","components/rule_form.jsx","actions/statisticActions.js","components/statistics.jsx","App.js","reducers/userReducers.js","reducers/deviceReducers.js","reducers/ruleReducers.js","reducers/statisticsReducers.js","reducers/index.js","index.js"],"names":["validate","require","classNames","trimDecorator","value","trim","roundDecorator","f","parseFloat","Number","isNaN","Math","round","Input","prop","type","id","label","state","setState","decorators","constraint","disabled","classes","error","Fragment","className","htmlFor","onChange","event","target","rest","onBlur","i","length","undefined","validation","fullMessages","placeholder","step","autoComplete","SelectInput","selectedId","selectedIndex","option","options","find","item","toString","name","findValue","map","required","allowEmpty","message","loginConstraints","username","presence","password","signupConstraints","minimum","maximum","tooShort","tooLong","format","pattern","confirmPassword","actionLogIn","actionLogOut","actionLoadDevices","actionLoadRules","actionNeedToLoad","actionLoadStatistics","logIn","communication","url","method","body","dispatch","removeCookie","Promise","resolve","reject","payload","init","credentials","JSON","stringify","fetch","then","result","status","json","succeed","authenticated","inputErrors","path","catch","restGet","restDelete","restPut","restPost","APP_URL_PATH","SERVER_PATH","calculatePasswordStrength","strength","match","Login","useState","setUsername","setPassword","setConfirmPassword","formDisabled","setFormDisabled","formError","setFormError","signup","setSignup","useDispatch","cookies","useCookies","setCookie","setterDict","validators","useEffect","document","title","response","loggedIn","haveUsers","evaluateInputErrors","errors","Object","entries","forEach","key","style","width","onSubmit","e","preventDefault","signupRules","window","location","reload","role","aria-hidden","loginRules","ConfirmationDialog","input","text","btnText","btnHandler","errorMessage","isLoading","btnType","btn","data-keyboard","tabIndex","fontSize","onClick","data-dismiss","MessageDialog","ErrorPage","LoadingPage","color","loadDevices","needToLoad","loadRules","Dashboard","devices","useSelector","rules","devicesLoaded","loaded","rulesLoaded","socket","setSocket","flippedCard","setFlippedCard","switchDisabled","setSwitchDisabled","msgDialog","setMsgDialog","deletionDialog","setDeletionDialog","pageError","setPageError","setLoading","history","useHistory","pad","num","timeToString","time","trunc","removeModal","$","modal","removeClass","remove","onpopstate","a","so","socketIOClient","hostname","disconnect","on","deleteEntity","isDevice","setData","obj","addClicked","push","cardClicked","switchEntity","editClicked","stopPropagation","deleteClicked","background","temperature","active","flipCard","toFixed","checked","rule","startTime","endTime","minTemp","maxTemp","activated","enabled","measuringDevice","controlDevice","deviceConstraints","flags","DeviceForm","isEdit","editId","useParams","deviceName","setDeviceName","deviceId","setDeviceId","isMeasuring","setMeasuring","setter","measuring","backToDashboard","replace","methodFunc","device","selector","ruleConstraints","numericality","tempCompare","RuleForm","ruleName","setRuleName","setStartTime","setEndTime","setMinTemp","setMaxTemp","setMeasuringDevice","setControlDevice","filter","setSelectorId","setRuleData","min","max","loadStatistics","moment","Statistics","statistics","socketUpdate","setSocketUpdate","lastTime","setLastTime","lastFormDisabled","setLastFormDisabled","lastFormError","setLastFormError","quantity","setQuantity","unit","setUnit","intervalFormDisabled","setIntervalFormDisabled","intervalFormError","setIntervalFormError","firstDate","setFirstDate","lastDate","setLastDate","isInter","setInter","offset","Date","getTimezoneOffset","constraints","lastConstraint","intervalConstraint","validDate","dateDiff","isValid","getTime","console","log","newList","temperatures","temp","currentTime","applyClicked","isInterval","update","b","query","getNum","setDate","date","n","parseInt","sum","getMultiplier","downloadFile","objToText","content","states","fileName","floor","element","createElement","href","URL","createObjectURL","Blob","download","appendChild","click","maxWidth","height","data-toggle","aria-haspopup","aria-expanded","aria-labelledby","chartType","loader","data","backgroundColor","fill","hAxis","gridlines","textStyle","units","days","hours","vAxis","baselineColor","legend","position","chartArea","colors","rootProps","App","user","PrivateRoute","children","cookie","render","loggedin","to","pathname","PublicRoute","exact","defaultState","userReducer","action","produce","draft","deviceReducer","ruleReducer","statisticsReducer","rootReducer","combineReducers","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","StrictMode","CookiesProvider","getElementById"],"mappings":"qRAEMA,EAAWC,EAAQ,IACnBC,EAAaD,EAAQ,IAEdE,EAAgB,SAACC,GAAD,OAAWA,EAAMC,QACjCC,EAAiB,SAACF,GAC7B,IAAMG,EAAIC,WAAWJ,GACrB,OAAQK,OAAOC,MAAMH,GAA+BH,EAA1BO,KAAKC,MAAU,GAAJL,GAAU,IAGpCM,EAAQ,SAACC,GAAU,IAE5BC,EACED,EADFC,KAAMC,EACJF,EADIE,GAAIC,EACRH,EADQG,MAAOC,EACfJ,EADeI,MAAOC,EACtBL,EADsBK,SAAUC,EAChCN,EADgCM,WAAYC,EAC5CP,EAD4CO,WAAYC,EACxDR,EADwDQ,SAwBtDC,EAAUrB,EAAW,CACzB,gBAAgB,EAChB,aAAcgB,EAAMM,QAGtB,OACE,eAAC,IAAMC,SAAP,WACE,uBAAOC,UAAU,aAAaC,QAASX,EAAvC,SAA4CC,IAC5C,uBAAOW,SA7Be,SAACC,GAAW,IAC5BzB,EAAUyB,EAAMC,OAAhB1B,MACRe,GAAS,SAACY,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,QAAOoB,MAAO,SA2BPQ,OAxBrB,WAAO,IAClB5B,EAAUc,EAAVd,MACN,GAAIgB,EAAY,CACd,IAAK,IAAIa,EAAI,EAAGA,EAAIb,EAAWc,OAAQD,GAAK,EAC1C7B,EAAQgB,EAAWa,GAAG7B,GAExBe,GAAS,SAACY,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,aAEjC,QAAmB+B,IAAfd,EAA0B,CAC5B,IAAMe,EAAapC,EAAS,CAAEI,SAASiB,EAAY,CAAEgB,cAAc,IAC/DD,GACFjB,GAAS,SAACY,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOY,EAAWhC,MAAM,UAaDW,KAAMA,EACvDW,UAAWH,EAASP,GAAIA,EAAIsB,YAAarB,EACzCb,MAAOc,EAAMd,MAAOkB,SAAUA,EAAUiB,KAAK,MAAMC,aAAa,SACrElB,GAAYJ,EAAMM,OAAS,qBAAKE,UAAU,mBAAf,SAAmCR,EAAMM,YAK/DiB,EAAc,SAAC3B,GAAU,IAElCE,EACEF,EADFE,GAAIC,EACFH,EADEG,MAAOC,EACTJ,EADSI,MAAOC,EAChBL,EADgBK,SAAUE,EAC1BP,EAD0BO,WAAYC,EACtCR,EADsCQ,SAcpCC,EAAUrB,EAAW,CACzB,iBAAiB,EACjB,cAAeoB,GAAYJ,EAAMM,QAWnC,OACE,eAAC,IAAMC,SAAP,WACE,uBAAOC,UAAU,aAAaC,QAASX,EAAvC,SAA4CC,IAC5C,yBACEW,SA5BoB,SAACC,GAAD,OAAWV,GAAS,SAACY,GAAD,mBAAC,eAAeA,GAAhB,IAAsBW,WAAYb,EAAMC,OAAOD,EAAMC,OAAOa,eAAe3B,GAAIQ,MAAO,SA6B9HQ,OA3Ba,WACjB,QAAmBG,IAAfd,EAA0B,CAC5B,IAAMe,EAAapC,EAAS,CAAEI,MAAOc,EAAMwB,YAAcrB,EAAY,CAAEgB,cAAc,IACjFD,GACFjB,GAAS,SAACY,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOY,EAAWhC,MAAM,UAwBvDY,GAAIA,EACJU,UAAWH,EACXD,SAAUA,EACVlB,MAjBY,WAChB,IAAKc,EAAMwB,WACT,MAAO,GAET,IAAME,EAAS1B,EAAM2B,QAAQC,MAAK,SAACC,GAAD,OAAUA,EAAK/B,GAAGgC,aAAe9B,EAAMwB,cACzE,OAAOE,EAASA,EAAOK,KAAO,GAYnBC,GANT,UAOE,wBAAQ9C,MAAM,KACbc,EAAM2B,QAAQM,KAAI,SAACJ,GAAD,OAAU,wBAAsB/B,GAAI+B,EAAK/B,GAA/B,SAAoC+B,EAAKE,MAA5BF,EAAK/B,WAE9CM,GAAYJ,EAAMM,OAAS,qBAAKE,UAAU,mBAAf,SAAmCR,EAAMM,YC/FvE4B,EAAW,CAAEC,YAAY,EAAOC,QAAS,2BAGlCC,EAAmB,CAC9BC,SAAU,CACRC,SAAUL,GAEZM,SAAU,CACRD,SAAUL,ICRRA,EAAW,CAAEC,YAAY,EAAOC,QAAS,2BAGlCK,EAAoB,CAC/BH,SAAU,CACRC,SAAUL,EACVlB,OAAQ,CACN0B,QAAS,EACTC,QAAS,GACTC,SAAU,oDACVC,QAAS,qDAEXC,OAAQ,CACNC,QAAS,mBACTX,QAAS,uEAGbI,SAAU,CACRD,SAAUL,EACVlB,OAAQ,CACN0B,QAAS,EACTC,QAAS,IACTC,SAAU,qDACVC,QAAS,sDAEXL,UAAU,GAEZQ,gBAAiB,CACfT,SAAUL,EACVc,iBAAiB,IC7BRC,EAAc,SACdC,EAAe,UAEfC,EAAoB,eAEpBC,EAAkB,aAElBC,EAAmB,eAEnBC,EAAuB,kBCPvBC,EAAQ,iBAAO,CAAE1D,KAAMoD,ICA9BO,EAAgB,SAACC,EAAKC,EAAQC,EAAMC,EAAUC,GAA9B,OAA+C,IAAIC,SACvE,SAACC,EAASC,GACR,IAAMC,EAAU,GACVC,EAAO,CAAER,SAAQS,YAAa,WAChCR,IACFO,EAAKP,KAAOS,KAAKC,UAAUV,IAE7BW,MAAMb,EAAKS,GAAMK,MAAK,SAACC,GAErB,OADAP,EAAQQ,OAASD,EAAOC,OACjBD,EAAOE,UACbH,MAAK,SAACC,GACHA,EAAOG,QACM,QAAXjB,EACFK,EAAQS,EAAOP,SAEfF,IAEQS,EAAOI,eAMjBX,EAAQ7B,QAAUoC,EAAOpC,QACrBoC,EAAOK,cACTZ,EAAQY,YAAeL,EAAOK,aAEhCb,EAAOC,KATPJ,EAAa,WAAY,CAAEiB,KAAM,MACjClB,EDlBqB,CAAE/D,KAAMqD,ICmB7Be,EAAQ7B,QAAU,mBAClB4B,EAAOC,OAQRc,OAAM,WACPd,EAAQ7B,QAAU,mCAClB4B,EAAOC,UAKAe,EAAU,SAACvB,EAAKG,EAAUC,GAAhB,OAAiC,IAAIC,SAAQ,SAACC,EAASC,GAC5ER,EAAcC,EAAK,MAAO,KAAMG,EAAUC,GAAcU,MAAK,SAACC,GAAD,OAAYT,EAAQS,MAASO,OAAM,SAACzE,GAAD,OAAW0D,EAAO1D,UAGvG2E,EAAa,SAACxB,EAAKG,EAAUC,GAAhB,OAAiC,IAAIC,SAAQ,SAACC,EAASC,GAC/ER,EAAcC,EAAK,SAAU,KAAMG,EAAUC,GAAcU,MAAK,SAACC,GAAD,OAAYT,EAAQS,MAASO,OAAM,SAACzE,GAAD,OAAW0D,EAAO1D,UAG1G4E,EAAU,SAACzB,EAAKE,EAAMC,EAAUC,GAAtB,OAAuC,IAAIC,SAAQ,SAACC,EAASC,GAClFR,EAAcC,EAAK,MAAOE,EAAMC,EAAUC,GAAcU,MAAK,SAACC,GAAD,OAAYT,EAAQS,MAASO,OAAM,SAACzE,GAAD,OAAW0D,EAAO1D,UAGvG6E,EAAW,SAAC1B,EAAKE,EAAMC,EAAUC,GAAtB,OAAuC,IAAIC,SAAQ,SAACC,EAASC,GACnFR,EAAcC,EAAK,OAAQE,EAAMC,EAAUC,GAAcU,MAAK,SAACC,GAAD,OAAYT,EAAQS,MAASO,OAAM,SAACzE,GAAD,OAAW0D,EAAO1D,UCnDxG8E,EAAe,IAGfC,EAAc,ICMZC,EATmB,SAACpG,GACjC,IAAIqG,EAAW,EAKf,OAJAA,GAAYrG,EAAMsG,MAAM,+gJAAgB,EAAI,EAC5CD,GAAYrG,EAAMsG,MAAM,k5IAAa,EAAI,EACzCD,GAAYrG,EAAMsG,MAAM,SAAW,EAAI,EACvCD,GAAYrG,EAAMsG,MAAM,0CAA4C,EAAI,GCMpE1G,EAAWC,EAAQ,IAuLV0G,EArLD,WAAO,IAAD,EACcC,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KAD3C,mBACXgC,EADW,KACDqD,EADC,OAEcD,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KAF3C,mBAEXkC,EAFW,KAEDoD,EAFC,OAG4BF,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KAHzD,mBAGX0C,EAHW,KAGM6C,EAHN,OAIsBH,oBAAS,GAJ/B,mBAIXI,EAJW,KAIGC,EAJH,OAKgBL,mBAAS,IALzB,mBAKXM,EALW,KAKAC,EALA,OAMUP,oBAAS,GANnB,mBAMXQ,EANW,KAMHC,EANG,KAQZvC,EAAWwC,cACXC,EAAUC,cACVC,EAAYF,EAAQ,GACpBxC,EAAewC,EAAQ,GAEvBG,EAAa,CACjBlE,SAAUqD,EACVnD,SAAUoD,EACV5C,gBAAiB6C,GAGnB/G,EAAS2H,WAAWjE,SAAW,SAACtD,GAAD,OAAYoG,EAA0BpG,GAAS,EAAI,gKAA6J+B,GAC/OnC,EAAS2H,WAAWzD,gBAAkB,SAAC9D,GAAD,OAAYA,IAAUsD,EAAStD,MAAQ,+BAA6B+B,GAE1GyF,qBAAU,WACRC,SAASC,MAAQ,WAChB,IAEHF,qBAAU,WACR1B,EAAQ,GAAD,OAAIK,EAAJ,iBAAgCzB,EAAUC,GAAcU,MAAK,SAACsC,GAC/DA,EAASC,SACXlD,EAASL,KACCsD,EAASE,WACnBZ,GAAU,QAGb,CAACvC,EAAUC,IAEd,IAAMmD,EAAsB,SAACC,GAC3BC,OAAOC,QAAQF,GAAQG,SAAQ,YAAmB,IAAD,mBAAhBC,EAAgB,KAAXnI,EAAW,KAC/CsH,EAAWa,IAAK,SAACxG,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOpB,EAAM,YAqDvD,OAAIgH,EAEA,qBAAK1F,UAAU,0CAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,KAArB,UACE,oBAAI/G,UAAU,wCAAd,qBACA,uBAAMgH,SA/BW,SAACC,GACxBA,EAAEC,iBACFzB,EAAa,IACb,IAAMtC,EAAO,CACXrB,SAAUA,EAASpD,MACnBsD,SAAUA,EAAStD,MACnB8D,gBAAiBA,EAAgB9D,OAE7BgC,EAAapC,EAAS6E,EAAMgE,EAAa,CAAExG,cAAc,IAC3DD,EACF8F,EAAoB9F,IAEpB6E,GAAgB,GAChBb,EAAQ,GAAD,OAAIG,EAAJ,cAA6B1B,EAAMC,EAAUC,GAAcU,MAAK,WACrEqD,OAAOC,SAASC,YACf/C,OAAM,SAACzE,GACRyF,GAAgB,GACZzF,EAAMuE,YACRmC,EAAoB1G,EAAMuE,aAE1BoB,EAAa3F,EAAM8B,cAWe5B,UAAU,OAA5C,UACE,qBAAKA,UAAU,aAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,gBACHC,MAAM,WACNC,MAAOsC,EACPrC,SAAU0F,EACVxF,WAAY,CAAEjB,MAAOyI,EAAYrF,UACjCpC,WAAY,CAACjB,GACbmB,SAAU0F,MAEnB,sBAAKtF,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,WACLC,GAAG,gBACHC,MAAM,WACNC,MAAOwC,EACPvC,SAAU2F,EACVzF,WAAY,CAAEjB,MAAOyI,EAAYnF,UACjCtC,WAAY,GACZE,SAAU0F,MAEnB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,WACLC,GAAG,uBACHC,MAAM,mBACNC,MAAOgD,EACP/C,SAAU4F,EACV1F,WAAY,CAAEjB,MAAOyI,EAAY3E,iBACjC9C,WAAY,GACZE,SAAU0F,SAGrB,qBAAKtF,UAAU,qCAAf,SACE,yBAAQX,KAAK,SAASW,UAAU,gBAAgBJ,SAAU0F,EAA1D,UACGA,GAAgB,sBAAMtF,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SADrG,iBAMHhC,GAAa,qBAAKxF,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuD/B,SAM3E,qBAAKxF,UAAU,0CAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,KAArB,UACE,oBAAI/G,UAAU,wCAAd,oBACA,uBAAMgH,SAvGY,SAACC,GACvBA,EAAEC,iBACFzB,EAAa,IACb,IAAMtC,EAAO,CAAErB,SAAUA,EAASpD,MAAOsD,SAAUA,EAAStD,OACtDgC,EAAapC,EAAS6E,EAAMsE,EAAY,CAAE9G,cAAc,IAC1DD,EACF8F,EAAoB9F,IAEpB6E,GAAgB,GAChBb,EAAQ,GAAD,OAAIG,EAAJ,aAA4B1B,EAAMC,EAAUC,GAAcU,MAAK,WACpEgC,EAAU,WAAY,IAAK,CAAEzB,KAAM,MACnClB,EAASL,QACRwB,OAAM,SAACzE,GACRyF,GAAgB,GACZzF,EAAMuE,YACRmC,EAAoB1G,EAAMuE,aAE1BoB,EAAa3F,EAAM8B,cAsFY5B,UAAU,OAA3C,UACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,gBACHC,MAAM,WACNC,MAAOsC,EACPrC,SAAU0F,EACVxF,WAAY,CAAEjB,MAAO+I,EAAW3F,UAChCpC,WAAY,GACZE,SAAU0F,MAEnB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,WACLC,GAAG,gBACHC,MAAM,WACNC,MAAOwC,EACPvC,SAAU2F,EACVzF,WAAY,CAAEjB,MAAO+I,EAAWzF,UAChCtC,WAAY,GACZE,SAAU0F,SAGrB,qBAAKtF,UAAU,qCAAf,SACE,yBAAQX,KAAK,SAASW,UAAU,gBAAgBJ,SAAU0F,EAA1D,UACGA,GAAgB,sBAAMtF,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SADrG,iBAMHhC,GAAa,qBAAKxF,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuD/B,U,kDC1LvEhH,EAAaD,EAAQ,IAEdmJ,EAAqB,SAACC,GAAW,IAE1CrI,EACEqI,EADFrI,GAAIsI,EACFD,EADEC,KAAMC,EACRF,EADQE,QAASC,EACjBH,EADiBG,WAAYC,EAC7BJ,EAD6BI,aAAcC,EAC3CL,EAD2CK,UAEzCC,EAAYN,EAAZM,QACDA,IACHA,EAAU,WAEZ,IAAMpI,EAAUrB,EAAW,aACzB0J,KAAK,GADmB,cAEhBD,IAAY,IAGtB,OACE,qBAAKjI,UAAU,aAAaV,GAAIA,EAAI6I,gBAAc,QAAQC,SAAS,KAAnE,SACE,qBAAKpI,UAAU,eAAf,SACE,qBAAKA,UAAU,uBAAf,SACE,sBAAKA,UAAU,aAAf,UACE,mBAAGA,UAAU,aAAa8G,MAAO,CAAEuB,SAAU,WAA7C,SAA2DT,IAC3D,gCACE,yBAAQU,QAASR,EAAYzI,KAAK,SAASW,UAAWH,EAASD,SAAUoI,EAAzE,UACGA,GAAa,sBAAMhI,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SAC/FK,KAEH,wBAAQxI,KAAK,SAASW,UAAU,6BAA6BuI,eAAa,QAA1E,uBAEDR,GAAgB,qBAAK/H,UAAU,+BAA+BuH,KAAK,QAAnD,SAA4DQ,cAQ5ES,EAAgB,SAACb,GAAW,IAC/BrI,EAAaqI,EAAbrI,GAAIsI,EAASD,EAATC,KAEZ,OACE,qBAAK5H,UAAU,aAAaV,GAAIA,EAAI6I,gBAAc,QAAQC,SAAS,KAAnE,SACE,qBAAKpI,UAAU,eAAf,SACE,qBAAKA,UAAU,uBAAf,SACE,sBAAKA,UAAU,aAAf,UACE,mBAAGA,UAAU,aAAa8G,MAAO,CAAEuB,SAAU,WAA7C,SAA2DT,IAC3D,8BACE,wBAAQvI,KAAK,SAASW,UAAU,6BAA6BuI,eAAa,QAA1E,4BClCCE,EAZG,SAACd,GAAW,IACpB1D,EAAoB0D,EAApB1D,OAAQrC,EAAY+F,EAAZ/F,QAChB,OACE,qBAAK5B,UAAU,qCAAf,SACE,gCACE,qBAAIA,UAAU,oCAAd,kBAAwDiE,GAAM,WAAQA,MACtE,oBAAIjE,UAAU,0BAAd,SAAyC4B,UCElC8G,GARK,kBAClB,qBAAK1I,UAAU,qCAAf,SACE,qBAAKA,UAAU,iBAAiBuH,KAAK,SAAST,MAAO,CAAE6B,MAAO,WAA9D,SACE,sBAAM3I,UAAU,UAAhB,6BCHO4I,GAAc,SAACnF,GAAD,MAAc,CAAEpE,KAAMsD,EAAmBc,YACvDoF,GAAa,iBAAO,CAAExJ,KAAMwD,ICA5BiG,GAAY,SAACrF,GAAD,MAAc,CAAEpE,KAAMuD,EAAiBa,YCU1DjF,GAAaD,EAAQ,IA4OZwK,GA1OG,WAChB,IAAMC,EAAUC,aAAY,SAACzJ,GAAD,OAAWA,EAAMwJ,QAAQA,WAC/CE,EAAQD,aAAY,SAACzJ,GAAD,OAAWA,EAAM0J,MAAMA,SAC3CC,EAAgBF,aAAY,SAACzJ,GAAD,OAAWA,EAAMwJ,QAAQI,UACrDC,EAAcJ,aAAY,SAACzJ,GAAD,OAAWA,EAAM0J,MAAME,UAJjC,EAKMlE,mBAAS,MALf,mBAKfoE,EALe,KAKPC,EALO,OAMgBrE,mBAAS,MANzB,mBAMfsE,EANe,KAMFC,EANE,OAOsBvE,oBAAS,GAP/B,mBAOfwE,EAPe,KAOCC,EAPD,OAQYzE,mBAAS,IARrB,mBAQf0E,EARe,KAQJC,EARI,OASsB3E,mBAAS,CACnD0C,KAAM,GACNE,WAAY,aACZE,WAAW,EACXD,aAAc,KAbM,mBASf+B,EATe,KASCC,EATD,OAgBY7E,mBAAS,IAhBrB,mBAgBf8E,EAhBe,KAgBJC,EAhBI,OAiBU/E,oBAAS,GAjBnB,mBAiBf8C,EAjBe,KAiBJkC,EAjBI,KAmBhBC,EAAUC,cACVhH,EAAWwC,cAEXvC,EADUyC,cACa,GAEvBuE,EAAM,SAACC,GAAD,OAAUA,EAAM,GAAN,WAAeA,GAAQA,GACvCC,GAAe,SAACC,GAAD,gBAAaH,EAAIpL,KAAKwL,MAAMD,EAAO,KAAnC,YAA2CH,EAAIG,EAAO,MAE3EtE,qBAAU,WACRC,SAASC,MAAQ,cAChB,IAEHF,qBAAU,WACR,IAAMwE,EAAc,WAClBtD,OAAOuD,EAAE,mBAAmBC,MAAM,QAClCxD,OAAOuD,EAAE,kBAAkBC,MAAM,QACjCxD,OAAOuD,EAAE,QAAQE,YAAY,cAC7BzD,OAAOuD,EAAE,mBAAmBG,UAG9B,OADA1D,OAAO2D,WAAaL,EACb,WACLA,IACAtD,OAAO2D,WAAa,gBAErB,IAEH7E,qBAAU,WACR,sBAAC,sBAAA8E,EAAA,sEAEQ7B,GAAkBE,GACrBa,GAAW,GAHhB,KAKG9G,EALH,KAKYwF,GALZ,SAK8BpE,EAAQ,GAAD,OAAIK,EAAJ,eAA8BzB,EAAUC,GAL7E,kEAMGD,EANH,KAMY0F,GANZ,UAM4BtE,EAAQ,GAAD,OAAIK,EAAJ,aAA4BzB,EAAUC,GANzE,yGAQG4G,EAAa,EAAD,IARf,yBAUGC,GAAW,GAVd,4EAAD,KAaC,CAAC9G,EAAUC,IAEd6C,qBAAU,WACR,IAAM+E,EAAKC,IAAe9D,OAAOC,SAAS8D,UAE1C,OADA5B,EAAU0B,GACH,WACLA,EAAGG,aACH7B,EAAU,SAEX,IAEHrD,qBAAU,WACJoD,IACFA,EAAO+B,GAAG,iBAAiB,SAAC5H,GAAD,OAAaL,EAASwF,GAAYnF,OAC7D6F,EAAO+B,GAAG,eAAe,SAAC5H,GAAD,OAAaL,EAAS0F,GAAUrF,UAE1D,CAACL,EAAUkG,IAEd,IAAMgC,GAAY,uCAAG,WAAOhM,EAAIiM,GAAX,eAAAP,EAAA,6DACbQ,EAAU,SAACC,GAAD,OAAS1B,GAAkB,SAAC1J,GAAD,mBAAC,eAAeA,GAASoL,OADjD,SAGjBD,EAAQ,CAAExD,WAAW,IAHJ,SAIXvD,EAAW,GAAD,OAAII,EAAJ,eAAsB0G,EAAW,UAAY,QAA7C,YAAwDjM,GAAM8D,EAAUC,GAJvE,OAKjB+D,OAAOuD,EAAE,mBAAmBC,MAAM,QALjB,gDAOjBY,EAAQ,CAAExD,WAAW,EAAOD,aAAa,UAAD,OAAY,KAAMnG,WAPzC,yDAAH,wDAWZ8J,GAAa,SAACH,GAClBpB,EAAQwB,KAAR,eAAqBJ,EAAW,SAAW,UAGvCK,GAAc,SAACtM,GACnBmK,EAAeD,IAAgBlK,EAAK,KAAOA,IAGvCuM,GAAe,SAACvM,EAAIiC,EAAM/B,EAAO+L,GACrC5B,GAAkB,GAClBhF,EAAS,GAAD,OAAIE,EAAJ,eAAsB0G,EAAW,UAAY,QAA7C,YAAwDjM,EAAxD,iBAA2E,CAAEE,SAAS4D,EAAUC,GAAcU,MAAK,WACzH4F,GAAkB,MAEjBpF,OAAM,SAACzE,GACN+J,EAAa,aAAD,OAAc0B,EAAQ,iBAAahK,GAAb,UAAyB/B,EAAQ,SAAW,UAA5C,YAAyD+B,GAA/E,aAA0FzB,EAAM8B,UAC5GwF,OAAOuD,EAAE,kBAAkBC,MAAM,YAIjCkB,GAAc,SAAC7E,EAAG3H,EAAIiM,GAC1BtE,EAAE8E,kBACF5B,EAAQwB,KAAR,WAAiBJ,EAAW,UAAY,QAAxC,YAAmDjM,KAG/C0M,GAAgB,SAAC/E,EAAG3H,EAAIiC,EAAMgK,GAClCtE,EAAE8E,kBACFhC,EAAkB,CAChBnC,KAAK,yBAAD,OAA2B2D,EAAW,SAAW,OAAjD,YAA2DhK,EAA3D,KACJuG,WAAY,kBAAMwD,GAAahM,EAAIiM,IACnCvD,WAAW,EACXD,aAAc,KAEhBX,OAAOuD,EAAE,mBAAmBC,MAAM,SAGpC,OAAIZ,EAAUpI,QACL,cAAC,EAAD,CAAWqC,OAAQ+F,EAAU/F,OAAQrC,QAASoI,EAAUpI,UAG7DoG,EACK,cAAC,GAAD,IAIP,eAAC,IAAMjI,SAAP,WACE,sBAAKC,UAAU,8CAA8C8G,MAAO,CAAEmF,WAAY,eAAlF,UACE,yBACA,sBAAM3D,QAAS,kBAAM6B,EAAQwB,KAAK,gBAAgB3L,UAAU,+EAA5D,4BAEJ,qBAAKA,UAAU,iDAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,KAArB,UACE,oBAAI/G,UAAU,uBAAd,qBACA,sBAAKA,UAAU,+CAAf,UACGgJ,EAAQvH,KAAI,YAEN,IADLnC,EACI,EADJA,GAAIiC,EACA,EADAA,KAAM2K,EACN,EADMA,YAAaC,EACnB,EADmBA,OAEjBtM,EAAUrB,GAAW,CAAE4N,UAAU,EAAM,aAAc5C,IAAgBlK,IAC3E,OACE,qBAAcU,UAAU,2CAAxB,SACE,sBAAKA,UAAWH,EAAhB,UACE,qBAAKyI,QAAS,kBAAMsD,GAAYtM,IAAKU,UAAU,2FAA/C,SACE,qBAAKA,UAAU,sBAAf,SACE,sBAAKA,UAAU,OAAf,UACE,wBAAQsI,QAAS,SAACrB,GAAD,OAAO6E,GAAY7E,EAAG3H,GAAI,IAAOD,KAAK,SAASW,UAAU,yCAA1E,kBACA,wBAAQsI,QAAS,SAACrB,GAAD,OAAO+E,GAAc/E,EAAG3H,EAAIiC,GAAM,IAAOlC,KAAK,SAASW,UAAU,uCAAlF,2BAIN,qBAAKsI,QAAS,kBAAMsD,GAAYtM,IAAKU,UAAU,yGAA/C,SACE,sBAAKA,UAAU,sBAAf,UACE,mBAAGA,UAAU,2CAAb,SAAyDuB,IACzD,oBAAIvB,UAAU,wBAAd,SAAuCkM,EAAW,UAAMA,EAAYG,QAAQ,GAA1B,UAAoC,QACtF,sBAAK/D,QAAS,SAACrB,GAAD,OAAOA,EAAE8E,mBAAmB/L,UAAU,2BAApD,UACE,uBAAOE,SAAU,kBAAM2L,GAAavM,EAAIiC,GAAO4K,GAAQ,IAAO9M,KAAK,WAAWW,UAAU,uBAAuBV,GAAE,aAAQA,GAAMgN,QAASH,EAAQvM,SAAU8J,IAC1J,uBAAO1J,UAAU,oBAAoBC,QAAO,aAAQX,iBAhBpDA,MAwBd,qBAAKgJ,QAAS,kBAAMoD,IAAW,IAAO1L,UAAU,2FAAhD,SACE,qBAAKA,UAAU,sBAAf,SACE,sBAAMA,UAAU,+CAAhB,wBAIN,oBAAIA,UAAU,4BAAd,mBACA,sBAAKA,UAAU,+CAAf,UACGkJ,EAAMzH,KAAI,SAAC8K,GAAU,IAElBjN,EACEiN,EADFjN,GAAIiC,EACFgL,EADEhL,KAAMiL,EACRD,EADQC,UAAWC,EACnBF,EADmBE,QAASC,EAC5BH,EAD4BG,QAASC,EACrCJ,EADqCI,QAASC,EAC9CL,EAD8CK,UAAWC,EACzDN,EADyDM,QAEvDhN,EAAUrB,GAAW,CAAE4N,UAAU,EAAM,aAAc5C,IAAgBlK,IAC3E,OACE,qBAAcU,UAAU,qCAAxB,SACE,sBAAKA,UAAWH,EAAhB,UACE,qBAAKyI,QAAS,kBAAMsD,GAAYtM,IAAKU,UAAU,qFAA/C,SACE,qBAAKA,UAAU,sBAAf,SACE,sBAAKA,UAAU,OAAf,UACE,wBAAQsI,QAAS,SAACrB,GAAD,OAAO6E,GAAY7E,EAAG3H,GAAI,IAAQD,KAAK,SAASW,UAAU,yCAA3E,kBACA,wBAAQsI,QAAS,SAACrB,GAAD,OAAO+E,GAAc/E,EAAG3H,EAAIiC,GAAM,IAAQlC,KAAK,SAASW,UAAU,uCAAnF,2BAIN,qBAAKsI,QAAS,kBAAMsD,GAAYtM,IAAKU,UAAU,mGAA/C,SACE,sBAAKA,UAAU,iBAAf,UACE,oBAAIA,UAAU,iCAAd,SAAgDuB,IAC/CqL,EAAY,mBAAG5M,UAAU,cAAb,oBAAwC,mBAAGA,UAAU,yBAAb,sBACrD,qBAAIA,UAAU,kBAAd,UAAiCuK,GAAaiC,GAA9C,SAA6DjC,GAAakC,MAC1E,qBAAIzM,UAAU,aAAd,UAA4B0M,EAAQL,QAAQ,GAA5C,eAAsDM,EAAQN,QAAQ,GAAtE,YACA,mBAAGrM,UAAU,uCAAb,sBACA,oBAAIA,UAAU,iCAAd,SAAgDuM,EAAKO,gBAAgBvL,OACrE,mBAAGvB,UAAU,uCAAb,yBACA,oBAAIA,UAAU,iCAAd,SAAgDuM,EAAKQ,cAAcxL,OACnE,sBAAK+G,QAAS,SAACrB,GAAD,OAAOA,EAAE8E,mBAAmB/L,UAAU,2BAApD,UACE,uBAAOE,SAAU,kBAAM2L,GAAavM,EAAIiC,GAAOsL,GAAS,IAAQxN,KAAK,WAAWW,UAAU,uBAAuBV,GAAE,aAAQA,GAAMgN,QAASO,EAASjN,SAAU8J,IAC7J,uBAAO1J,UAAU,oBAAoBC,QAAO,aAAQX,iBAtBpDA,MA8Bd,qBAAKgJ,QAAS,kBAAMoD,IAAW,IAAQ1L,UAAU,qFAAjD,SACE,qBAAKA,UAAU,sBAAf,SACE,sBAAMA,UAAU,+CAAhB,wBAIN,cAAC,EAAD,CAAoBV,GAAG,iBACHsI,KAAMkC,EAAelC,KACrBC,QAAQ,SACRI,QAAQ,SACRH,WAAYgC,EAAehC,WAC3BE,UAAW8B,EAAe9B,UAC1BD,aAAc+B,EAAe/B,eACjD,cAAC,EAAD,CAAezI,GAAG,gBAAgBsI,KAAMgC,aClP1ClI,GAAW,CAAEC,YAAY,EAAOC,QAAS,2BAGlCoL,GAAoB,CAC/BzL,KAAM,CACJQ,SAAUL,GACVlB,OAAQ,CACN0B,QAAS,EACTC,QAAS,GACTC,SAAU,gDACVC,QAAS,iDAEXC,OAAQ,CACNC,QAAS,UACT0K,MAAO,IACPrL,QAAS,wDAGbtC,GAAI,CACFyC,SAAUL,GACVlB,OAAQ,CACN0B,QAAS,EACTC,QAAS,GACTC,SAAU,8CACVC,QAAS,+CAEXC,OAAQ,CACNC,QAAS,eACT0K,MAAO,IACPrL,QAAS,yDCjBTtD,GAAWC,EAAQ,IAmJV2O,GAjJI,SAAC9N,GAAU,IACpB+N,EAAW/N,EAAX+N,OAEFC,EAAUC,cAAa/N,GAHF,EAKS4F,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KALtC,mBAKpBwN,EALoB,KAKRC,EALQ,OAMKrI,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KANlC,mBAMpB0N,EANoB,KAMVC,EANU,OAOSvI,oBAAS,GAPlB,mBAOpBwI,EAPoB,KAOPC,EAPO,OAQazI,oBAAS,GARtB,mBAQpBI,EARoB,KAQNC,EARM,OASOL,mBAAS,IAThB,mBASpBM,EAToB,KASTC,EATS,OAWOP,mBAAS,IAXhB,mBAWpB8E,EAXoB,KAWTC,EAXS,OAYK/E,oBAAS,GAZd,mBAYpB8C,EAZoB,KAYTkC,EAZS,KAcrBC,EAAUC,cACVhH,EAAWwC,cAEXvC,EADUyC,cACa,GAEvBE,EAAa,CAAEzE,KAAMgM,EAAejO,GAAImO,GAE9CvH,qBAAU,WACRC,SAASC,MAAT,UAAoB+G,EAAS,OAAS,MAAtC,aACC,CAACA,IAEJjH,qBAAU,WACJiH,IACFjD,GAAW,GACX1F,EAAQ,GAAD,OAAIK,EAAJ,uBAA8BuI,GAAUhK,EAAUC,GAAcU,MAAK,SAACC,GAC3E,IAAMwH,EAAU,SAACoC,EAAQlP,GAAT,OAAmBkP,GAAO,SAACvN,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,cAChE8M,EAAQ+B,EAAevJ,EAAOzC,MAC9BiK,EAAQiC,EAAazJ,EAAOwJ,UAC5BG,EAAa3J,EAAO6J,WACpB3D,GAAW,MACV3F,OAAM,SAACzE,GACRmK,EAAanK,GACboK,GAAW,SAGd,CAACiD,EAAQC,EAAQhK,EAAUC,IAE9B,IAAMyK,EAAkB,WACtB3D,EAAQ4D,QAAQ,MA6ClB,OAAI/D,EAAUpI,QACL,cAAC,EAAD,CAAWqC,OAAQ+F,EAAU/F,OAAQrC,QAASoI,EAAUpI,UAG7DoG,EACK,cAAC,GAAD,IAIP,qBAAKhI,UAAU,0CAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,KAArB,UACE,qBAAI/G,UAAU,wCAAd,UAAuDmN,EAAS,OAAS,MAAzE,aACA,uBAAMnG,SAtDO,SAAC7G,GAClBA,EAAM+G,iBACNzB,EAAa,IACb,IAAMe,EAAsB,SAACC,GAC3BC,OAAOC,QAAQF,GAAQG,SAAQ,YAAmB,IAAD,mBAAhBC,EAAgB,KAAXnI,EAAW,KAC/CsH,EAAWa,IAAK,SAACxG,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOpB,EAAM,YAIjDgC,EAAapC,GAAS,CAC1BiD,KAAM+L,EAAW5O,MACjBY,GAAIkO,EAAS9O,OACZwK,GAAO,CAAEvI,cAAc,IAE1B,GAAID,EACF8F,EAAoB9F,OACf,CACL6E,GAAgB,GAChB,IACIyI,EADE7K,EAAO,CAAE5B,KAAM+L,EAAW5O,MAAO8O,SAAUA,EAAS9O,MAAOgP,eAE7DP,GACFhK,EAAK7D,GAAK8N,EACVY,EAAarJ,GAEbqJ,EAAatJ,EAGfsJ,EAAW,GAAD,OAAInJ,EAAJ,eAA8B1B,EAAMC,EAAUC,GAAcU,MAAK,WACzEX,EAASyF,MACTiF,OAECvJ,OAAM,SAACzE,GACNyF,GAAgB,GACZzF,EAAMuE,YACRmC,EAAoB1G,EAAMuE,aAE1BoB,EAAa,UAAD,OAAW3F,EAAM8B,eAkBL5B,UAAU,OAAtC,UACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,kBACHC,MAAM,cACNC,MAAO8N,EACP7N,SAAU8N,EACV5N,WAAY,CAAEjB,MAAOwK,GAAM3H,MAC3B7B,WAAY,CAACjB,GACbmB,SAAU0F,MAEnB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,gBACHC,MAAM,YACNC,MAAOgO,EACP/N,SAAUgO,EACV9N,WAAY,CAAEjB,MAAOwK,GAAM5J,IAC3BI,WAAY,CAACjB,GACbmB,SAAU0F,SAGrB,sBAAKtF,UAAU,aAAf,UACE,mBAAGA,UAAU,8BAAb,8BACA,sBAAKsI,QAAS,SAACrB,GAAD,OAAOA,EAAE8E,mBAAmB/L,UAAU,qBAApD,UACE,uBAAOE,SAAU,kBAAMyN,GAAcD,IAAcrO,KAAK,WAAWW,UAAU,uBAAuBV,GAAG,MAAMgN,QAASoB,EAAa9N,SAAU0F,IAC7I,uBAAOtF,UAAU,oBAAoBC,QAAQ,cAGjD,qBAAKD,UAAU,qCAAf,SACE,gCACE,yBAAQX,KAAK,SAASW,UAAU,gBAAgBJ,SAAU0F,EAA1D,UACGA,GAAgB,sBAAMtF,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SAClG2F,EAAS,OAAS,MAFrB,aAIA,wBAAQ7E,QAASwF,EAAiBzO,KAAK,SAASW,UAAU,6BAA6BJ,SAAU0F,EAAjG,4BAILE,GAAa,qBAAKxF,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuD/B,UCzJvE9D,GAAW,CAAEC,YAAY,EAAOC,QAAS,2BACzC4I,GAAO,CACXzI,SAAUL,GACVY,OAAQ,CACNC,QAAS,kCACTX,QAAS,uBAGPqM,GAAS,CACblM,SAAUL,GACVwM,UAAU,GAICC,GAAkB,CAC7B5M,KAAM,CACJQ,SAAUL,GACVlB,OAAQ,CACN0B,QAAS,EACTC,QAAS,GACTC,SAAU,gDACVC,QAAS,iDAEXC,OAAQ,CACNC,QAAS,UACT0K,MAAO,IACPrL,QAAS,wDAGb4K,UAAWhC,GACXiC,QAASjC,GACTkC,QAAS,CACP3K,SAAUL,GACV0M,aAAc,CACZxM,QAAS,0BAGb+K,QAAS,CACP5K,SAAUL,GACV0M,aAAc,CACZxM,QAAS,yBAEXyM,aAAa,GAGfvB,gBAAiBmB,GACjBlB,cAAekB,IChCX3P,GAAWC,EAAQ,IAqPV+P,GAnPE,SAAClP,GAAU,IAClB+N,EAAW/N,EAAX+N,OAEFC,EAAUC,cAAa/N,GAHJ,EAKO4F,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KALpC,mBAKlByO,EALkB,KAKRC,EALQ,OAMStJ,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KANtC,mBAMlB0M,EANkB,KAMPiC,EANO,OAOKvJ,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KAPlC,mBAOlB2M,EAPkB,KAOTiC,EAPS,OAQKxJ,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KARlC,mBAQlB4M,EARkB,KAQTiC,EARS,OASKzJ,mBAAS,CAAExG,MAAO,GAAIoB,MAAO,KATlC,mBASlB6M,EATkB,KASTiC,EATS,OAUqB1J,mBAAS,CAAE/D,QAAS,GAAIH,WAAY,KAAMlB,MAAO,KAVtE,mBAUlBgN,EAVkB,KAUD+B,EAVC,OAWiB3J,mBAAS,CAAE/D,QAAS,GAAIH,WAAY,KAAMlB,MAAO,KAXlE,mBAWlBiN,EAXkB,KAWH+B,EAXG,OAae5J,oBAAS,GAbxB,mBAalBI,EAbkB,KAaJC,EAbI,OAcSL,mBAAS,IAdlB,oBAclBM,GAdkB,MAcPC,GAdO,SAgBSP,mBAAS,IAhBlB,qBAgBlB8E,GAhBkB,MAgBPC,GAhBO,SAiBO/E,oBAAS,GAjBhB,qBAiBlB8C,GAjBkB,MAiBPkC,GAjBO,MAmBnBC,GAAUC,cACVhH,GAAWwC,cAEXvC,GADUyC,cACa,GAE7BI,qBAAU,WACRC,SAASC,MAAT,UAAoB+G,EAAS,OAAS,MAAtC,WACC,CAACA,IAEJjH,qBAAU,WACR,IAAMmE,EAAM,SAACC,GAAD,OAAUA,EAAM,GAAN,WAAeA,GAAQA,GACvCC,EAAe,SAACC,GAAD,gBAAaH,EAAIpL,KAAKwL,MAAMD,EAAO,KAAnC,YAA2CH,EAAIG,EAAO,MAC3E,sBAAC,oCAAAQ,EAAA,+EAEyBxG,EAAQ,GAAD,OAAIK,EAAJ,eAA8BzB,GAAUC,IAFxE,UAES2F,EAFT,QAGSwC,EAAU,SAACoC,EAAQzM,GAAT,OAAqByM,GAAO,SAACvN,GAAD,mBAAC,eAAeA,GAAhB,IAAsBc,iBAC1D0N,EAAoB7F,EACzB+F,QAAO,SAACd,GAAD,OAAiC,IAArBA,EAAOJ,aAC1BpM,KAAI,SAACJ,GAAD,MAAW,CAAE/B,GAAI+B,EAAK/B,GAAIiC,KAAMF,EAAKE,UAC5CiK,EAAQsD,EAAkB9F,EAAQvH,KAAI,SAACJ,GAAD,MAAW,CAAE/B,GAAI+B,EAAK/B,GAAIiC,KAAMF,EAAKE,WACvE4L,EARP,kCASwB3I,EAAQ,GAAD,OAAIK,EAAJ,qBAA4BuI,GAAUhK,GAAUC,IAT/E,QASWkJ,EATX,OAWWyC,EAAgB,SAACpB,EAAQ5M,GAAT,OAAwB4M,GAAO,SAACvN,GAAD,mBAAC,eAAeA,GAAhB,IAAsBW,oBADrEiO,EAAc,SAACrB,EAAQlP,GAAT,OAAmBkP,GAAO,SAACvN,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,eAExD8P,EAAajC,EAAKhL,MAC9B0N,EAAYR,EAAclE,EAAagC,EAAKC,YAC5CyC,EAAYP,EAAYnE,EAAagC,EAAKE,UAC1CwC,EAAYN,EAAYpC,EAAKG,SAC7BuC,EAAYL,EAAYrC,EAAKI,SAC7BqC,EAAcH,EAAoBtC,EAAKO,iBACvCkC,EAAcF,EAAkBvC,EAAKQ,eAlB1C,QAoBG7C,IAAW,GApBd,kDAsBGD,GAAa,EAAD,IACZC,IAAW,GAvBd,yDAAD,GA0BAA,IAAW,KACV,CAAC7G,GAAcD,GAAUgK,EAAQD,IAEpC,IAAMnH,GAAa,CACjBzE,KAAMiN,EACNhC,UAAWiC,EACXhC,QAASiC,EACThC,QAASiC,EACThC,QAASiC,EACT9B,gBAAiB+B,EACjB9B,cAAe+B,GAGjBxQ,GAAS2H,WAAWiI,SAAW,SAACxP,GAC9B,IAAKA,EACH,MAAO,2BAKXJ,GAAS2H,WAAWoI,YAAc,SAAC3P,GACjC,IAAMwQ,EAAMpQ,WAAW4N,EAAQhO,OACzByQ,EAAMrQ,WAAWJ,GACvB,IAAIK,OAAOC,MAAMkQ,KAAQnQ,OAAOC,MAAMmQ,GAGtC,OAAIA,EAAMD,EACD,iFADT,GAMF,IAAMpB,GAAkB,WACtB3D,GAAQ4D,QAAQ,MAoDlB,OAAI/D,GAAUpI,QACL,cAAC,EAAD,CAAWqC,OAAQ+F,GAAU/F,OAAQrC,QAASoI,GAAUpI,UAG7DoG,GACK,cAAC,GAAD,IAIP,qBAAKhI,UAAU,0CAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,KAArB,UACE,qBAAI/G,UAAU,wCAAd,UAAuDmN,EAAS,OAAS,MAAzE,WACA,uBAAMnG,SA7DO,SAAC7G,GAClBA,EAAM+G,iBACNzB,GAAa,IACb,IAuBMuI,EAvBAxH,EAAsB,SAACC,GAC3BC,OAAOC,QAAQF,GAAQG,SAAQ,YAAmB,IAAD,mBAAhBC,EAAgB,KAAXnI,EAAW,KAC/CsH,GAAWa,IAAK,SAACxG,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOpB,EAAM,YAIjDyE,EAAO,CACX5B,KAAMgN,EAAS7P,MACf8N,UAAWA,EAAU9N,MACrB+N,QAASA,EAAQ/N,MACjBgO,QAASA,EAAQhO,MACjBiO,QAASA,EAAQjO,MACjBoO,gBAAiBA,EAAgB9L,WACjC+L,cAAeA,EAAc/L,YAGzBN,EAAapC,GAAS6E,EAAM+F,GAAO,CAAEvI,cAAc,IACrDD,EACF8F,EAAoB9F,IAEpB6E,GAAgB,GAChBpC,EAAKuJ,QAAUzN,KAAKC,MAAiC,GAA3BJ,WAAWqE,EAAKuJ,UAAiB,GAC3DvJ,EAAKwJ,QAAU1N,KAAKC,MAAiC,GAA3BJ,WAAWqE,EAAKwJ,UAAiB,GAEvDQ,GACFhK,EAAK7D,GAAK8N,EACVY,EAAarJ,GAEbqJ,EAAatJ,EAGfsJ,EAAW,GAAD,OAAInJ,EAAJ,aAA4B1B,EAAMC,GAAUC,IAAcU,MAAK,WACvEX,GAASyF,MACTiF,QAECvJ,OAAM,SAACzE,GACNyF,GAAgB,GACZzF,EAAMuE,YACRmC,EAAoB1G,EAAMuE,aAE1BoB,GAAa,UAAD,OAAW3F,EAAM8B,eAkBL5B,UAAU,OAAtC,UACE,qBAAKA,UAAU,aAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,gBACHC,MAAM,YACNC,MAAO+O,EACP9O,SAAU+O,EACV7O,WAAY,CAAEjB,MAAOwK,GAAM3H,MAC3B7B,WAAY,CAACjB,GACbmB,SAAU0F,MAEnB,sBAAKtF,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,iBACHC,MAAM,aACNC,MAAOgN,EACP/M,SAAUgP,EACV9O,WAAY,CAAEjB,MAAOwK,GAAMsD,WAC3B9M,WAAY,GACZE,SAAU0F,MAEnB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,eACHC,MAAM,WACNC,MAAOiN,EACPhN,SAAUiP,EACV/O,WAAY,CAAEjB,MAAOwK,GAAMuD,SAC3B/M,WAAY,GACZE,SAAU0F,SAGrB,sBAAKtF,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,SACLC,GAAG,eACHC,MAAM,sBACNC,MAAOkN,EACPjN,SAAUkP,EACVhP,WAAY,CAAEjB,MAAOwK,GAAMwD,SAC3BhN,WAAY,CAACd,GACbgB,SAAU0F,MAEnB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,SACLC,GAAG,eACHC,MAAM,sBACNC,MAAOmN,EACPlN,SAAUmP,EACVjP,WAAY,CAAEjB,MAAOwK,GAAMyD,SAC3BjN,WAAY,CAACd,GACbgB,SAAU0F,SAGrB,sBAAKtF,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAaV,GAAG,qBACHC,MAAM,mBACNC,MAAOsN,EACPrN,SAAUoP,EACVlP,WAAY,CAAEjB,MAAOwK,GAAM4D,iBAC3BlN,SAAU0F,MAEzB,qBAAKtF,UAAU,sBAAf,SACE,cAAC,EAAD,CAAaV,GAAG,qBACHC,MAAM,oBACNC,MAAOuN,EACPtN,SAAUqP,EACVnP,WAAY,CAAEjB,MAAOwK,GAAM6D,eAC3BnN,SAAU0F,SAG3B,qBAAKtF,UAAU,qCAAf,SACE,gCACE,yBAAQX,KAAK,SAASW,UAAU,gBAAgBJ,SAAU0F,EAA1D,UACGA,GAAgB,sBAAMtF,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SAClG2F,EAAS,OAAS,MAFrB,WAIA,wBAAQ7E,QAASwF,GAAiBzO,KAAK,SAASW,UAAU,6BAA6BJ,SAAU0F,EAAjG,4BAILE,IAAa,qBAAKxF,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuD/B,W,kBC1PhE4J,GAAiB,SAAC3L,GAAD,MAAc,CAAEpE,KAAMyD,EAAsBW,YCQpE4L,GAAS9Q,EAAQ,KACjBD,GAAWC,EAAQ,IA4YV+Q,GA1YI,WACjB,IAAMtG,EAAUC,aAAY,SAACzJ,GAAD,OAAWA,EAAM+P,WAAWvG,WADjC,EAEiB9D,mBAAS,MAF1B,mBAEhBsK,EAFgB,KAEFC,EAFE,OAGSvK,mBAAS,OAHlB,mBAGhBwK,EAHgB,KAGNC,EAHM,OAKyBzK,oBAAS,GALlC,mBAKhB0K,EALgB,KAKEC,EALF,OAMmB3K,mBAAS,IAN5B,mBAMhB4K,EANgB,KAMDC,EANC,OAOS7K,mBAAS,CAAExG,MAAO,IAAKoB,MAAO,KAPvC,mBAOhBkQ,EAPgB,KAONC,EAPM,OAQC/K,mBAAS,CAC/B/D,QAAS,CACP,CAAE7B,GAAI,QAASiC,KAAM,SACrB,CAAEjC,GAAI,OAAQiC,KAAM,QACpB,CAAEjC,GAAI,QAASiC,KAAM,SACrB,CAAEjC,GAAI,SAAUiC,KAAM,UACtB,CAAEjC,GAAI,QAASiC,KAAM,UAEvBP,WAAY,QACZlB,MAAO,KAjBc,mBAQhBoQ,EARgB,KAQVC,EARU,OAoBiCjL,oBAAS,GApB1C,mBAoBhBkL,EApBgB,KAoBMC,EApBN,OAqB2BnL,mBAAS,IArBpC,mBAqBhBoL,EArBgB,KAqBGC,EArBH,OAsBWrL,mBAAS,CAAExG,MAAO,GAAI8L,KAAM,GAAI1K,MAAO,KAtBlD,mBAsBhB0Q,EAtBgB,KAsBLC,EAtBK,OAuBSvL,mBAAS,CAAExG,MAAO,GAAI8L,KAAM,GAAI1K,MAAO,KAvBhD,mBAuBhB4Q,EAvBgB,KAuBNC,EAvBM,QAyBKzL,oBAAS,GAzBd,qBAyBhB0L,GAzBgB,MAyBPC,GAzBO,SA2BK3L,mBAAS,MA3Bd,qBA2BhBoE,GA3BgB,MA2BRC,GA3BQ,MA6BjBnG,GAAWwC,cAEXvC,GADUyC,cACa,GACvBqE,GAAUC,cAEV0G,GAA4C,KAAlC,IAAIC,MAAQC,oBAEtBhL,GAAa,CACjBwK,UAAWC,EACXC,SAAUC,EACVX,SAAUC,EACVC,KAAMC,GAGFzO,GAAW,CAAEC,YAAY,EAAOC,QAAS,2BACzCqP,GAAc,CAClBC,eAAgB,CACdlB,SAAU,CACRjO,SAAUL,IAEZwO,KAAM,CACJnO,SAAUL,GACVwM,UAAU,IAGdiD,mBAAoB,CAClBX,UAAW,CACTzO,SAAUL,GACV0P,WAAW,GAEbV,SAAU,CACR3O,SAAUL,GACV0P,WAAW,EACXC,UAAU,KAKhB/S,GAAS2H,WAAWiI,SAAW,SAACxP,GAC9B,IAAKA,EACH,MAAO,2BAKXJ,GAAS2H,WAAWmL,UAAY,SAAC1S,GAC/B,IAAK2Q,GAAO,IAAI0B,KAAKrS,IAAS4S,UAG9B,MAAO,uBAGThT,GAAS2H,WAAWoL,SAAW,SAAC3S,GAC9B,KAAK,IAAIqS,KAAKrS,GAAQ6S,WAAc,IAAIR,KAAKP,EAAU9R,OAAQ6S,WAG/D,MAAO,sDAGTrL,qBAAU,WACRC,SAASC,MAAQ,eAChB,IAEHF,qBAAU,WACR1B,EAAQ,GAAD,OAAIK,EAAJ,qCAA4C,OAAezB,GAAUC,IAAcU,MAAK,SAACC,GAC9FZ,GAASgM,GAAepL,OACvBO,OAAM,SAACzE,GACR0R,QAAQC,IAAR,iBAAsB3R,EAAM8B,eAE7B,CAACwB,GAAUC,KAEd6C,qBAAU,WACR,IAAM+E,EAAKC,IAAe9D,OAAOC,SAAS8D,UAE1C,OADA5B,GAAU0B,GACH,WACLA,EAAGG,aACH7B,GAAU,SAEX,IAEHrD,qBAAU,WACJoD,IACFA,GAAO+B,GAAG,sBAAsB,SAAC5H,GAC/BgM,EAAgBhM,QAGnB,CAACL,GAAUkG,KAEdpD,qBAAU,WACR,GAAqB,OAAjBsJ,EAAuB,CACzB,IAAMkC,EAAU1I,EAAQvH,KAAI,SAACJ,GAC3B,GAAIA,EAAK/B,KAAOkQ,EAAahC,SAC3B,OAAOnM,EAET,IAAIsQ,EAAY,aAAQtQ,EAAKsQ,cAE7B,GADAA,EAAahG,KAAK6D,EAAatD,aAC3B0E,GACFe,EAAeA,EAAa5C,QAC1B,SAAC6C,GAAD,OAAUA,EAAK,IAAO,IAAIb,KAAKP,EAAU9R,OAAQ6S,WAC5CK,EAAK,GAAM,IAAIb,KAAKL,EAAShS,OAAQ6S,UAAY,aAEnD,CACL,IAAMM,GAAe,IAAId,MAAQQ,UACjCI,EAAeA,EAAa5C,QAAO,SAAC6C,GAAD,OAAUC,EAAcD,EAAK,IAAMlC,KAExE,MAAO,CAAEpQ,GAAI+B,EAAK/B,GAAIiC,KAAMF,EAAKE,KAAMoQ,mBAEzCvO,GAASgM,GAAesC,IACxBjC,EAAgB,SAEjB,CAACzG,EAAS5F,GAAUoN,EAAU9R,MAAOkS,GAASF,EAAShS,MAAOgR,EAAUF,IAE3E,IAAMsC,GAAe,SAACC,GACpBlB,GAASkB,GACT,IAAMvL,EAAsB,SAACC,GAC3BC,OAAOC,QAAQF,GAAQG,SAAQ,YAAmB,IAAD,mBAAhBC,EAAgB,KAAXnI,EAAW,KAC/CsH,GAAWa,IAAK,SAACxG,GAAD,mBAAC,eAAeA,GAAhB,IAAsBP,MAAOpB,EAAM,YAGjD6G,EAAkBwM,EAAa1B,EAA0BR,EACzDpK,EAAesM,EAAaxB,EAAuBR,EACnDiC,EAAS,SAAChH,EAAGiH,GACjBxM,EAAa,IACbF,GAAgB,GAChB,IAAM2M,EAASH,EAAD,oBAA6C/G,EAAI8F,GAAjD,qBAAoEmB,EAAInB,IAAxE,mBAA0B9F,GACxCxG,EAAQ,GAAD,OAAIK,EAAJ,4BAAmCqN,GAAS9O,GAAUC,IAAcU,MAAK,SAACC,GAC/EZ,GAASgM,GAAepL,IACxBuB,GAAgB,MACfhB,OAAM,SAACzE,GACJA,EAAMuE,YACRmC,EAAoB1G,EAAMuE,aAE1BoB,EAAa,UAAD,OAAW3F,EAAM8B,UAE/B2D,GAAgB,OAIpB,GAAIwM,EAAY,CACd,IAAM5O,EAAO,CACXqN,UAAWA,EAAU9R,MACrBgS,SAAUA,EAAShS,OAEfgC,EAAapC,GAAS6E,EAAM8N,GAAYE,mBAAoB,CAAExQ,cAAc,IAClF,GAAID,EACF8F,EAAoB9F,OACf,CACL,IAAMyR,EAAS,SAAC3H,GAAD,OAAW,IAAIuG,KAAKvG,GAAO+G,WACpCa,EAAU,SAACC,EAAMzE,GAAP,OAAkBA,GAChC,SAACvN,GAAD,mBAAC,eAAeA,GAAhB,IAAsBmK,KAAM2H,EAAOE,SAErCD,EAAQ5B,EAAU9R,MAAO+R,GACzB2B,EAAQ1B,EAAShS,MAAOiS,GACxBqB,EAAOG,EAAO3B,EAAU9R,OAAQyT,EAAOzB,EAAShS,aAE7C,CACL,IAAMyE,EAAO,CACX6M,SAAUA,EAAStR,MACnBwR,KAAMA,EAAKlP,YAGPN,EAAapC,GAAS6E,EAAM8N,GAAYC,eAAgB,CAAEvQ,cAAc,IAC9E,GAAID,EACF8F,EAAoB9F,OACf,CACL,IAAM4R,EAAIC,SAASvC,EAAStR,MAAO,IACnC,IAAKK,OAAOC,MAAMsT,GAAI,CACpB,IASME,EAAMF,EATU,WACpB,OAAQpC,EAAKlP,YACX,IAAK,QAAS,QAAS,OAAO,KAC9B,IAAK,OAAQ,OAAO,MACpB,IAAK,QAAS,OAAO,OACrB,IAAK,SAAU,OAAO,UACtB,IAAK,QAAS,OAAO,YAGTyR,GAChB9C,EAAY6C,GACZR,EAAOQ,OAMTE,GAAe,SAAClF,EAAUjM,EAAMlC,GACpC,IAAMsT,EAAY,SAACC,GAAD,OAAahP,KAAKC,UAAU+O,EAAS,KAAM,IACzDA,EAAU5J,EAAQvH,KACpB,SAACwM,GAAD,MAAa,CACX3O,GAAI2O,EAAO3O,GACXiC,KAAM0M,EAAO1M,KACboQ,aAAc1D,EAAO0D,aAAalQ,KAAI,SAACJ,GAAD,MAAU,CAAC,IAAI0P,KAAK1P,EAAK,IAAKA,EAAK,OACzEwR,OAAQ5E,EAAO4E,OAAOpR,KAAI,SAACJ,GAAD,MAAU,CAAC,IAAI0P,KAAK1P,EAAK,IAAKA,EAAK,WAE/DD,MAAK,SAAC6M,GAAD,OAAYA,EAAO3O,KAAOkO,KAC7BsF,EAAWlC,GAAO,UACfrP,EADe,oBACE8N,GAAOmB,EAAUhG,MAAOlI,OAAO,cADjC,YACmD+M,GAAOqB,EAASlG,MAAOlI,OAAO,eADjF,UAEff,EAFe,YAEN8N,KAAU/M,OAAO,oBAFX,iBAEuCrD,KAAK8T,MAAMrD,EAAW,MAF7D,UAGtB,OAAQrQ,GACN,IAAK,OACHuT,EAAUD,EAAUC,GACpBE,EAAQ,UAAMA,EAAN,SACR,MACF,IAAK,MACHF,EAAUD,EAAUC,GACpBE,EAAQ,UAAMA,EAAN,QACR,MACF,QACEF,EAAUD,EAAUC,GACpBE,EAAQ,UAAMA,EAAN,SAIZ,IAAME,EAAU7M,SAAS8M,cAAc,KACvCD,EAAQE,KAAOC,IAAIC,gBAAgB,IAAIC,KAAK,CAACT,GAAU,CAAEvT,KAAM,gBAC/D2T,EAAQM,SAAWR,EACnB3M,SAAShD,KAAKoQ,YAAYP,GAC1BA,EAAQQ,SAGV,OACE,eAAC,IAAMzT,SAAP,WACE,sBAAKC,UAAU,8CAA8C8G,MAAO,CAAEmF,WAAY,eAAlF,UACE,yBACA,sBAAM3D,QAAS,kBAAM6B,GAAQ4D,QAAQ,MAAM/N,UAAU,+EAArD,0BAEJ,oBAAIA,UAAU,6CAAd,wBACA,qBAAKA,UAAU,gCAAf,SACE,sBAAK8G,MAAO,CAAEC,MAAO,IAAK0M,SAAU,KAApC,UACE,sBAAMzT,UAAU,OAAhB,SACE,sBAAKA,UAAU,0CAAf,UACI,qBAAKA,UAAU,sDAAf,SACE,sBAAKA,UAAU,iBAAf,UACE,oBAAIA,UAAU,yCAAd,sBACA,sBAAKA,UAAU,gBAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,SACLC,GAAG,gBACHC,MAAM,WACNI,WAAY,CAAEjB,MAAOuS,GAAYC,eAAelB,UAChDpQ,SAAUgQ,EACVpQ,MAAOwQ,EACPvQ,SAAUwQ,MAEnB,qBAAKjQ,UAAU,sBAAf,SACE,cAAC,EAAD,CAAaV,GAAG,YACHC,MAAM,OACNI,WAAY,CAAEjB,MAAOuS,GAAYC,eAAehB,MAChDtQ,SAAUgQ,EACVpQ,MAAO0Q,EACPzQ,SAAU0Q,MAEzB,yBAAQ7H,QAAS,kBAAMwJ,IAAa,IAAQzS,KAAK,SAASW,UAAU,gCAAgCJ,SAAUgQ,EAA9G,UACGA,GAAoB,sBAAM5P,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SADzG,cAKDsI,GAAiB,qBAAK9P,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuDuI,SAG/E,qBAAK9P,UAAU,sDAAf,SACE,sBAAKA,UAAU,iBAAf,UACE,oBAAIA,UAAU,yCAAd,sBACF,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,iBACHC,MAAM,aACNI,WAAY,CAAEjB,MAAOuS,GAAYE,mBAAmBX,WACpD5Q,SAAUwQ,EACV5Q,MAAOgR,EACP/Q,SAAUgR,MAEnB,qBAAKzQ,UAAU,sBAAf,SACE,cAAC,EAAD,CAAOX,KAAK,OACLC,GAAG,gBACHC,MAAM,YACNI,WAAY,CAAEjB,MAAOuS,GAAYE,mBAAmBT,UACpD9Q,SAAUwQ,EACV5Q,MAAOkR,EACPjR,SAAUkR,MAEnB,yBAAQrI,QAAS,kBAAMwJ,IAAa,IAAOzS,KAAK,SAASW,UAAU,gCAAgCJ,SAAUwQ,EAA7G,UACGA,GAAwB,sBAAMpQ,UAAU,wCAAwCuH,KAAK,SAASC,cAAY,SAD7G,cAKC8I,GAAqB,qBAAKtQ,UAAU,0BAA0BuH,KAAK,QAA9C,SAAuD+I,cAKvF,qBAAKtQ,UAAU,2DAAf,SACGgJ,EAAQxI,OAAS,GAAKwI,EAAQvH,KAAI,SAACwM,GAAD,OAC/B,qBAAqBjO,UAAU,2DAA2D8G,MAAO,CAAEC,MAAO,IAAK0M,SAAU,IAAKC,OAAQ,KAAtI,SACE,sBAAK1T,UAAU,wBAAf,UACE,qBAAIA,UAAU,2CAA2C8G,MAAO,CAAEuB,SAAU,IAA5E,UACG4F,EAAO1M,KACR,sBAAKvB,UAAU,iBAAiBuH,KAAK,QAArC,UACE,wBAAQjI,GAAG,gBAAgBD,KAAK,SAASW,UAAU,+CAC3C2T,cAAY,WAAWC,gBAAc,OAAOC,gBAAc,QADlE,sBAIA,sBAAK7T,UAAU,gBAAgB8T,kBAAgB,gBAA/C,UACE,wBAAQzU,KAAK,SAASW,UAAU,oCAAoCsI,QAAS,kBAAMoK,GAAazE,EAAO3O,GAAI2O,EAAO1M,KAAM,SAAxH,kBACA,wBAAQlC,KAAK,SAASW,UAAU,oCAAoCsI,QAAS,kBAAMoK,GAAazE,EAAO3O,GAAI2O,EAAO1M,KAAM,QAAxH,0BAIL0M,EAAO0D,aAAanR,OAAS,EAC5B,cAAC,KAAD,CACEuG,MAAO,OACP2M,OAAQ,QACRK,UAAU,YACVC,OAAQ,yCACRC,KAAI,CACF,CAAC,IAAK,gBADJ,oBAEEhG,EAAO0D,aAAalQ,KAAI,SAACmQ,GAAD,MAAU,CAAC,IAAIb,KAAKa,EAAK,IAAKA,EAAK,SAEjEzQ,QAAS,CACP+S,gBAAiB,CACfC,KAAM,eAERC,MAAO,CACLC,UAAW,CACT1L,MAAO,eAET2L,UAAW,CACT3L,MAAO,SAET4L,MAAO,CACLC,KAAM,CAAElS,OAAQ,CAAC,WACjBmS,MAAO,CAAEnS,OAAQ,CAAC,QAAS,SAG/BoS,MAAO,CACLL,UAAW,CACT1L,MAAO,WAETgM,cAAe,UACfL,UAAW,CACT3L,MAAO,UAGXiM,OAAQ,CAAEC,SAAU,QACpBC,UAAW,CACT/N,MAAO,MACP2M,OAAQ,OAEVqB,OAAQ,CAAC,YAEXC,UAAW,CAAE,cAAe,OAG9B,mBAAGhV,UAAU,wBAAb,yBA5DIiO,EAAO3O,kBCpRd2V,GA9CH,WACV,IAAM3O,EAAW2C,aAAY,SAACzJ,GAAD,OAAWA,EAAM0V,KAAK5O,YAE7C6O,EAAe,SAACxN,GAAW,IACvByN,EAAsBzN,EAAtByN,SAAa/U,EADS,YACAsH,EADA,gBAEb7B,YAAW,CAAC,aAAtBuP,EAFuB,oBAG9B,OAAO,cAAC,IAAD,2BAAWhV,GAAX,IAAiBiV,OAAQ,iBAA4B,MAApBD,EAAOE,UAAoBjP,EAAa8O,EAAa,cAAC,IAAD,CAAUI,GAAI,CAAEC,SAAS,GAAD,OAAK7Q,EAAL,iBAGjH8Q,EAAc,SAAC/N,GAAW,IACtByN,EAAsBzN,EAAtByN,SAAa/U,EADQ,YACCsH,EADD,cAE7B,OAAO,cAAC,IAAD,2BAAWtH,GAAX,IAAiBiV,OAAQ,kBAAOhP,EAAY,cAAC,IAAD,CAAUkP,GAAI,CAAEC,SAAS,GAAD,OAAK7Q,MAAyBwQ,OAG3G,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAACM,EAAD,CAAapR,KAAI,UAAKM,EAAL,SAAjB,SACE,cAAC,EAAD,MAEF,cAACuQ,EAAD,CAAc7Q,KAAI,UAAKM,EAAL,cAAlB,SACE,cAAC,GAAD,MAEF,cAACuQ,EAAD,CAAc7Q,KAAI,UAAKM,EAAL,cAAlB,SACE,cAAC,GAAD,CAAYuI,QAAQ,MAEtB,cAACgI,EAAD,CAAc7Q,KAAI,UAAKM,EAAL,YAAlB,SACE,cAAC,GAAD,CAAUuI,QAAQ,MAEpB,cAACgI,EAAD,CAAc7Q,KAAI,UAAKM,EAAL,eAAlB,SACE,cAAC,GAAD,CAAYuI,QAAQ,MAEtB,cAACgI,EAAD,CAAc7Q,KAAI,UAAKM,EAAL,aAAlB,SACE,cAAC,GAAD,CAAUuI,QAAQ,MAEpB,cAACgI,EAAD,CAAcQ,OAAK,EAACrR,KAAI,UAAKM,GAA7B,SACE,cAAC,GAAD,MAEF,cAAC8Q,EAAD,CAAapR,KAAK,IAAlB,SACE,cAAC,EAAD,CAAWL,OAAQ,IAAKrC,QAAQ,uB,SClDpCgU,GAAe,CACnBtP,UAAU,GAgBGuP,GAbK,WAAmC,IAAlCrW,EAAiC,uDAAzBoW,GAAcE,EAAW,uCACpD,OAAQA,EAAOzW,MACb,KAAKoD,EACH,OAAOsT,aAAQvW,GAAO,SAACwW,GACrBA,EAAM1P,UAAW,KAErB,KAAK5D,EACH,OAAOkT,GACT,QACE,OAAOpW,ICbPoW,GAAe,CACnBxM,QAAQ,EACRJ,QAAS,IAmBIiN,GAhBO,WAAmC,IAAlCzW,EAAiC,uDAAzBoW,GAAcE,EAAW,uCACtD,OAAQA,EAAOzW,MACb,KAAKsD,EACH,OAAOoT,aAAQvW,GAAO,SAACwW,GACrBA,EAAMhN,QAAU8M,EAAOrS,QACvBuS,EAAM5M,QAAS,KAEnB,KAAKvG,EACH,OAAOkT,aAAQvW,GAAO,SAACwW,GACrBA,EAAM5M,QAAS,KAEnB,QACE,OAAO5J,ICjBPoW,GAAe,CACnBxM,QAAQ,EACRF,MAAO,IAmBMgN,GAhBK,WAAmC,IAAlC1W,EAAiC,uDAAzBoW,GAAcE,EAAW,uCACpD,OAAQA,EAAOzW,MACb,KAAKuD,EACH,OAAOmT,aAAQvW,GAAO,SAACwW,GACrBA,EAAM9M,MAAQ4M,EAAOrS,QACrBuS,EAAM5M,QAAS,KAEnB,KAAKvG,EACH,OAAOkT,aAAQvW,GAAO,SAACwW,GACrBA,EAAM5M,QAAS,KAEnB,QACE,OAAO5J,ICjBPoW,GAAe,CACnB5M,QAAS,IAcImN,GAXW,WAAmC,IAAlC3W,EAAiC,uDAAzBoW,GAAcE,EAAW,uCAC1D,OAAQA,EAAOzW,MACb,KAAKyD,EACH,OAAOiT,aAAQvW,GAAO,SAACwW,GACrBA,EAAMhN,QAAU8M,EAAOrS,WAE3B,QACE,OAAOjE,ICDE4W,GAPKC,YAAgB,CAClCnB,KAAMW,GACN7M,QAASiN,GACT/M,MAAOgN,GACP3G,WAAY4G,KCARG,GAAQC,YACZH,GAEAhP,OAAOoP,8BAAgCpP,OAAOoP,gCAGhDC,IAASnB,OACP,cAAC,IAAMoB,WAAP,UACE,cAAC,IAAD,CAAUJ,MAAOA,GAAjB,SACE,cAACK,EAAA,EAAD,UACE,cAAC,GAAD,UAINxQ,SAASyQ,eAAe,U","file":"static/js/main.7ec5d07b.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst validate = require('validate.js');\r\nconst classNames = require('classnames');\r\n\r\nexport const trimDecorator = (value) => value.trim();\r\nexport const roundDecorator = (value) => {\r\n  const f = parseFloat(value);\r\n  return !Number.isNaN(f) ? Math.round(f * 10) / 10 : value;\r\n};\r\n\r\nexport const Input = (prop) => {\r\n  const {\r\n    type, id, label, state, setState, decorators, constraint, disabled,\r\n  } = prop;\r\n\r\n  const handleInputChange = (event) => {\r\n    const { value } = event.target;\r\n    setState((rest) => ({ ...rest, value, error: '' }));\r\n  };\r\n\r\n  const handleBlur = () => {\r\n    let { value } = state;\r\n    if (decorators) {\r\n      for (let i = 0; i < decorators.length; i += 1) {\r\n        value = decorators[i](value);\r\n      }\r\n      setState((rest) => ({ ...rest, value }));\r\n    }\r\n    if (constraint !== undefined) {\r\n      const validation = validate({ value }, constraint, { fullMessages: false });\r\n      if (validation) {\r\n        setState((rest) => ({ ...rest, error: validation.value[0] }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const classes = classNames({\r\n    'form-control': true,\r\n    'is-invalid': state.error,\r\n  });\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <label className=\"text-light\" htmlFor={id}>{label}</label>\r\n      <input onChange={handleInputChange} onBlur={handleBlur} type={type}\r\n             className={classes} id={id} placeholder={label}\r\n             value={state.value} disabled={disabled} step=\"any\" autoComplete=\"off\"/>\r\n      {!disabled && state.error && <div className=\"invalid-feedback\">{state.error}</div>}\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport const SelectInput = (prop) => {\r\n  const {\r\n    id, label, state, setState, constraint, disabled,\r\n  } = prop;\r\n\r\n  const handleInputChange = (event) => setState((rest) => ({ ...rest, selectedId: event.target[event.target.selectedIndex].id, error: '' }));\r\n\r\n  const handleBlur = () => {\r\n    if (constraint !== undefined) {\r\n      const validation = validate({ value: state.selectedId }, constraint, { fullMessages: false });\r\n      if (validation) {\r\n        setState((rest) => ({ ...rest, error: validation.value[0] }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const classes = classNames({\r\n    'custom-select': true,\r\n    'is-invalid': !disabled && state.error,\r\n  });\r\n\r\n  const findValue = () => {\r\n    if (!state.selectedId) {\r\n      return '';\r\n    }\r\n    const option = state.options.find((item) => item.id.toString() === state.selectedId);\r\n    return option ? option.name : '';\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <label className=\"text-light\" htmlFor={id}>{label}</label>\r\n      <select\r\n        onChange={handleInputChange}\r\n        onBlur={handleBlur}\r\n        id={id}\r\n        className={classes}\r\n        disabled={disabled}\r\n        value={findValue()}>\r\n        <option value=\"\"/>\r\n        {state.options.map((item) => <option key={item.id} id={item.id}>{item.name}</option>)}\r\n      </select>\r\n      { !disabled && state.error && <div className=\"invalid-feedback\">{state.error}</div>}\r\n    </React.Fragment>\r\n  );\r\n};\r\n","const required = { allowEmpty: false, message: 'This field is required.' };\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const loginConstraints = {\r\n  username: {\r\n    presence: required,\r\n  },\r\n  password: {\r\n    presence: required,\r\n  },\r\n};\r\n","const required = { allowEmpty: false, message: 'This field is required.' };\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const signupConstraints = {\r\n  username: {\r\n    presence: required,\r\n    length: {\r\n      minimum: 4,\r\n      maximum: 25,\r\n      tooShort: 'The username must be between 4 and 32 characters.',\r\n      tooLong: 'The username must be between 4 and 32 characters.',\r\n    },\r\n    format: {\r\n      pattern: '[a-z|0-9|\\\\.|_]+',\r\n      message: 'The usernames must only contain lowercase alphanumeric characters.',\r\n    },\r\n  },\r\n  password: {\r\n    presence: required,\r\n    length: {\r\n      minimum: 8,\r\n      maximum: 128,\r\n      tooShort: 'The password must be between 8 and 128 characters.',\r\n      tooLong: 'The password must be between 8 and 128 characters.',\r\n    },\r\n    password: true,\r\n  },\r\n  confirmPassword: {\r\n    presence: required,\r\n    confirmPassword: true,\r\n  },\r\n};\r\n","export const actionLogIn = 'LOG_IN';\r\nexport const actionLogOut = 'LOG_OUT';\r\n\r\nexport const actionLoadDevices = 'LOAD_DEVICES';\r\n\r\nexport const actionLoadRules = 'LOAD_RULES';\r\n\r\nexport const actionNeedToLoad = 'NEED_TO_LOAD';\r\n\r\nexport const actionLoadStatistics = 'LOAD_STATISTICS';\r\n","import { actionLogIn, actionLogOut } from './actionTypes';\r\n\r\nexport const logIn = () => ({ type: actionLogIn });\r\nexport const logOut = () => ({ type: actionLogOut });\r\n","import { logOut } from '../actions/userActions';\r\n\r\nconst communication = (url, method, body, dispatch, removeCookie) => new Promise(\r\n  (resolve, reject) => {\r\n    const payload = {};\r\n    const init = { method, credentials: 'include' };\r\n    if (body) {\r\n      init.body = JSON.stringify(body);\r\n    }\r\n    fetch(url, init).then((result) => {\r\n      payload.status = result.status;\r\n      return result.json();\r\n    }).then((result) => {\r\n      if (result.succeed) {\r\n        if (method === 'GET') {\r\n          resolve(result.payload);\r\n        } else {\r\n          resolve();\r\n        }\r\n      } else if (!result.authenticated) {\r\n        removeCookie('loggedin', { path: '/' });\r\n        dispatch(logOut());\r\n        payload.message = 'Unauthenticated.';\r\n        reject(payload);\r\n      } else {\r\n        payload.message = result.message;\r\n        if (result.inputErrors) {\r\n          payload.inputErrors =  result.inputErrors;\r\n        }\r\n        reject(payload);\r\n      }\r\n    }).catch(() => {\r\n      payload.message = 'Failed to connect to the server.';\r\n      reject(payload);\r\n    });\r\n  },\r\n);\r\n\r\nexport const restGet = (url, dispatch, removeCookie) => new Promise((resolve, reject) => {\r\n  communication(url, 'GET', null, dispatch, removeCookie).then((result) => resolve(result)).catch((error) => reject(error));\r\n});\r\n\r\nexport const restDelete = (url, dispatch, removeCookie) => new Promise((resolve, reject) => {\r\n  communication(url, 'DELETE', null, dispatch, removeCookie).then((result) => resolve(result)).catch((error) => reject(error));\r\n});\r\n\r\nexport const restPut = (url, body, dispatch, removeCookie) => new Promise((resolve, reject) => {\r\n  communication(url, 'PUT', body, dispatch, removeCookie).then((result) => resolve(result)).catch((error) => reject(error));\r\n});\r\n\r\nexport const restPost = (url, body, dispatch, removeCookie) => new Promise((resolve, reject) => {\r\n  communication(url, 'POST', body, dispatch, removeCookie).then((result) => resolve(result)).catch((error) => reject(error));\r\n});\r\n","export const APP_URL_PATH = '/';\r\n\r\n// export const SERVER_PATH = 'http://localhost/';\r\nexport const SERVER_PATH = '/';\r\n","const calculatePasswordStrength = (value) => {\r\n  let strength = 0;\r\n  strength += value.match(/[\\p{Ll}]+/u) ? 1 : 0;\r\n  strength += value.match(/\\p{Lu}/u) ? 1 : 0;\r\n  strength += value.match(/[0-9]/) ? 1 : 0;\r\n  strength += value.match(/[`~!@#$%^&*()\\-_=+{}[\\]\\\\|;:'\",<.>/?]+/) ? 1 : 0;\r\n  return strength;\r\n};\r\n\r\nexport default calculatePasswordStrength;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useCookies } from 'react-cookie';\r\nimport { Input, trimDecorator } from './form_utils.jsx';\r\nimport { loginConstraints as loginRules } from '../constraints/loginConstraints';\r\nimport { signupConstraints as signupRules } from '../constraints/signupConstraints';\r\nimport { restGet, restPut } from '../utils/communication';\r\nimport { SERVER_PATH } from '../constants';\r\nimport { logIn } from '../actions/userActions';\r\nimport calculatePasswordStrength from '../utils/password';\r\n\r\nconst validate = require('validate.js');\r\n\r\nconst Login = () => {\r\n  const [username, setUsername] = useState({ value: '', error: '' });\r\n  const [password, setPassword] = useState({ value: '', error: '' });\r\n  const [confirmPassword, setConfirmPassword] = useState({ value: '', error: '' });\r\n  const [formDisabled, setFormDisabled] = useState(false);\r\n  const [formError, setFormError] = useState('');\r\n  const [signup, setSignup] = useState(false);\r\n\r\n  const dispatch = useDispatch();\r\n  const cookies = useCookies();\r\n  const setCookie = cookies[1];\r\n  const removeCookie = cookies[2];\r\n\r\n  const setterDict = {\r\n    username: setUsername,\r\n    password: setPassword,\r\n    confirmPassword: setConfirmPassword,\r\n  };\r\n\r\n  validate.validators.password = (value) => (calculatePasswordStrength(value) < 2 ? 'The password must contain at least two character categories among the following: uppercase characters, lowercase characters, digits, special characters.' : undefined);\r\n  validate.validators.confirmPassword = (value) => (value !== password.value ? 'Password doesn\\'t match.' : undefined);\r\n\r\n  useEffect(() => {\r\n    document.title = 'Log in';\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    restGet(`${SERVER_PATH}api/logged-in`, dispatch, removeCookie).then((response) => {\r\n      if (response.loggedIn) {\r\n        dispatch(logIn());\r\n      } else if (!response.haveUsers) {\r\n        setSignup(true);\r\n      }\r\n    });\r\n  }, [dispatch, removeCookie]);\r\n\r\n  const evaluateInputErrors = (errors) => {\r\n    Object.entries(errors).forEach(([key, value]) => {\r\n      setterDict[key]((rest) => ({ ...rest, error: value[0] }));\r\n    });\r\n  };\r\n\r\n  const submitLoginForm = (e) => {\r\n    e.preventDefault();\r\n    setFormError('');\r\n    const body = { username: username.value, password: password.value };\r\n    const validation = validate(body, loginRules, { fullMessages: false });\r\n    if (validation) {\r\n      evaluateInputErrors(validation);\r\n    } else {\r\n      setFormDisabled(true);\r\n      restPut(`${SERVER_PATH}api/login`, body, dispatch, removeCookie).then(() => {\r\n        setCookie('loggedin', '1', { path: '/' });\r\n        dispatch(logIn());\r\n      }).catch((error) => {\r\n        setFormDisabled(false);\r\n        if (error.inputErrors) {\r\n          evaluateInputErrors(error.inputErrors);\r\n        } else {\r\n          setFormError(error.message);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  const submitSignupForm = (e) => {\r\n    e.preventDefault();\r\n    setFormError('');\r\n    const body = {\r\n      username: username.value,\r\n      password: password.value,\r\n      confirmPassword: confirmPassword.value,\r\n    };\r\n    const validation = validate(body, signupRules, { fullMessages: false });\r\n    if (validation) {\r\n      evaluateInputErrors(validation);\r\n    } else {\r\n      setFormDisabled(true);\r\n      restPut(`${SERVER_PATH}api/signup`, body, dispatch, removeCookie).then(() => {\r\n        window.location.reload();\r\n      }).catch((error) => {\r\n        setFormDisabled(false);\r\n        if (error.inputErrors) {\r\n          evaluateInputErrors(error.inputErrors);\r\n        } else {\r\n          setFormError(error.message);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  if (signup) {\r\n    return (\r\n      <div className=\"d-flex justify-content-center mb-4 mx-2\">\r\n        <div style={{ width: 500 }}>\r\n          <h1 className=\"display-4 text-light mt-4 text-center\">Sign Up</h1>\r\n          <form onSubmit={submitSignupForm} className=\"mt-5\">\r\n            <div className=\"form-group\">\r\n              <Input type=\"text\"\r\n                     id=\"inputUsername\"\r\n                     label=\"Username\"\r\n                     state={username}\r\n                     setState={setUsername}\r\n                     constraint={{ value: signupRules.username }}\r\n                     decorators={[trimDecorator]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-row\">\r\n              <div className=\"form-group col-md-6\">\r\n                <Input type=\"password\"\r\n                       id=\"inputPassword\"\r\n                       label=\"Password\"\r\n                       state={password}\r\n                       setState={setPassword}\r\n                       constraint={{ value: signupRules.password }}\r\n                       decorators={[]}\r\n                       disabled={formDisabled} />\r\n              </div>\r\n              <div className=\"form-group col-md-6\">\r\n                <Input type=\"password\"\r\n                       id=\"inputConfirmPassword\"\r\n                       label=\"Confirm password\"\r\n                       state={confirmPassword}\r\n                       setState={setConfirmPassword}\r\n                       constraint={{ value: signupRules.confirmPassword }}\r\n                       decorators={[]}\r\n                       disabled={formDisabled} />\r\n              </div>\r\n            </div>\r\n            <div className=\"d-flex justify-content-center mt-5\">\r\n              <button type=\"submit\" className=\"btn btn-light\" disabled={formDisabled}>\r\n                {formDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                Log In\r\n              </button>\r\n            </div>\r\n          </form>\r\n          {formError && <div className=\"alert alert-danger mt-5\" role=\"alert\">{formError}</div>}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"d-flex justify-content-center mb-4 mx-2\">\r\n      <div style={{ width: 500 }}>\r\n        <h1 className=\"display-4 text-light mt-4 text-center\">Log In</h1>\r\n        <form onSubmit={submitLoginForm} className=\"mt-5\">\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"text\"\r\n                     id=\"inputUsername\"\r\n                     label=\"Username\"\r\n                     state={username}\r\n                     setState={setUsername}\r\n                     constraint={{ value: loginRules.username }}\r\n                     decorators={[]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"password\"\r\n                     id=\"inputPassword\"\r\n                     label=\"Password\"\r\n                     state={password}\r\n                     setState={setPassword}\r\n                     constraint={{ value: loginRules.password }}\r\n                     decorators={[]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex justify-content-center mt-5\">\r\n            <button type=\"submit\" className=\"btn btn-light\" disabled={formDisabled}>\r\n              {formDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n              Log In\r\n            </button>\r\n          </div>\r\n        </form>\r\n        {formError && <div className=\"alert alert-danger mt-5\" role=\"alert\">{formError}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import React from 'react';\r\n\r\nconst classNames = require('classnames');\r\n\r\nexport const ConfirmationDialog = (input) => {\r\n  const {\r\n    id, text, btnText, btnHandler, errorMessage, isLoading,\r\n  } = input;\r\n  let { btnType } = input;\r\n  if (!btnType) {\r\n    btnType = 'primary';\r\n  }\r\n  const classes = classNames({\r\n    btn: true,\r\n    [`btn-${btnType}`]: true,\r\n  });\r\n\r\n  return (\r\n    <div className=\"modal fade\" id={id} data-keyboard=\"false\" tabIndex=\"-1\">\r\n      <div className=\"modal-dialog\">\r\n        <div className=\"modal-content darkBg\">\r\n          <div className=\"modal-body\">\r\n            <p className=\"text-light\" style={{ fontSize: '1.25rem' }}>{text}</p>\r\n            <div>\r\n              <button onClick={btnHandler} type=\"button\" className={classes} disabled={isLoading}>\r\n                {isLoading && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                {btnText}\r\n              </button>\r\n              <button type=\"button\" className=\"btn btn-outline-light ml-2\" data-dismiss=\"modal\">Cancel</button>\r\n            </div>\r\n            {errorMessage && <div className=\"alert alert-danger mt-4 mb-0\" role=\"alert\">{errorMessage}</div>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const MessageDialog = (input) => {\r\n  const { id, text } = input;\r\n\r\n  return (\r\n    <div className=\"modal fade\" id={id} data-keyboard=\"false\" tabIndex=\"-1\">\r\n      <div className=\"modal-dialog\">\r\n        <div className=\"modal-content darkBg\">\r\n          <div className=\"modal-body\">\r\n            <p className=\"text-light\" style={{ fontSize: '1.25rem' }}>{text}</p>\r\n            <div>\r\n              <button type=\"button\" className=\"btn btn-outline-light ml-2\" data-dismiss=\"modal\">OK</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\nconst ErrorPage = (input) => {\r\n  const { status, message } = input;\r\n  return (\r\n    <div className=\"d-flex justify-content-center mt-4\">\r\n      <div>\r\n        <h1 className=\"text-center text-danger display-4\">ERROR{status && ` ${status}`}</h1>\r\n        <h4 className=\"text-center text-danger\">{message}</h4>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ErrorPage;\r\n","import React from 'react';\r\n\r\nconst LoadingPage = () => (\r\n  <div className=\"d-flex justify-content-center mt-4\">\r\n    <div className=\"spinner-border\" role=\"status\" style={{ color: '#80DEEA' }}>\r\n      <span className=\"sr-only\">Loading...</span>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default LoadingPage;\r\n","import { actionLoadDevices, actionNeedToLoad } from './actionTypes';\r\n\r\nexport const loadDevices = (payload) => ({ type: actionLoadDevices, payload });\r\nexport const needToLoad = () => ({ type: actionNeedToLoad });\r\n","import { actionLoadRules } from './actionTypes';\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const loadRules = (payload) => ({ type: actionLoadRules, payload });\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useCookies } from 'react-cookie';\r\nimport socketIOClient from 'socket.io-client';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { restGet, restDelete, restPost } from '../utils/communication';\r\nimport { SERVER_PATH } from '../constants';\r\nimport { ConfirmationDialog, MessageDialog } from './dialog_utils.jsx';\r\nimport ErrorPage from './error_page.jsx';\r\nimport LoadingPage from './loading_page.jsx';\r\nimport { loadDevices } from '../actions/deviceActions';\r\nimport { loadRules } from '../actions/ruleActions';\r\n\r\nconst classNames = require('classnames');\r\n\r\nconst Dashboard = () => {\r\n  const devices = useSelector((state) => state.devices.devices);\r\n  const rules = useSelector((state) => state.rules.rules);\r\n  const devicesLoaded = useSelector((state) => state.devices.loaded);\r\n  const rulesLoaded = useSelector((state) => state.rules.loaded);\r\n  const [socket, setSocket] = useState(null);\r\n  const [flippedCard, setFlippedCard] = useState(null);\r\n  const [switchDisabled, setSwitchDisabled] = useState(false);\r\n  const [msgDialog, setMsgDialog] = useState('');\r\n  const [deletionDialog, setDeletionDialog] = useState({\r\n    text: '',\r\n    btnHandler: () => {},\r\n    isLoading: false,\r\n    errorMessage: '',\r\n  });\r\n\r\n  const [pageError, setPageError] = useState({});\r\n  const [isLoading, setLoading] = useState(false);\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const cookies = useCookies();\r\n  const removeCookie = cookies[2];\r\n\r\n  const pad = (num) => (num < 10 ? `0${num}` : num);\r\n  const timeToString = (time) => `${pad(Math.trunc(time / 60))}:${pad(time % 60)}`;\r\n\r\n  useEffect(() => {\r\n    document.title = 'Dashboard';\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const removeModal = () => {\r\n      window.$('#deletionDialog').modal('hide');\r\n      window.$('#messageDialog').modal('hide');\r\n      window.$('body').removeClass('modal-open');\r\n      window.$('.modal-backdrop').remove();\r\n    };\r\n    window.onpopstate = removeModal;\r\n    return () => {\r\n      removeModal();\r\n      window.onpopstate = () => {};\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        if (!devicesLoaded || !rulesLoaded) {\r\n          setLoading(true);\r\n        }\r\n        dispatch(loadDevices(await restGet(`${SERVER_PATH}api/devices`, dispatch, removeCookie)));\r\n        dispatch(loadRules(await restGet(`${SERVER_PATH}api/rules`, dispatch, removeCookie)));\r\n      } catch (error) {\r\n        setPageError(error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, [dispatch, removeCookie]);\r\n\r\n  useEffect(() => {\r\n    const so = socketIOClient(window.location.hostname);\r\n    setSocket(so);\r\n    return () => {\r\n      so.disconnect();\r\n      setSocket(null);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('device update', (payload) => dispatch(loadDevices(payload)));\r\n      socket.on('rule update', (payload) => dispatch(loadRules(payload)));\r\n    }\r\n  }, [dispatch, socket]);\r\n\r\n  const deleteEntity = async (id, isDevice) => {\r\n    const setData = (obj) => setDeletionDialog((rest) => ({ ...rest, ...obj }));\r\n    try {\r\n      setData({ isLoading: true });\r\n      await restDelete(`${SERVER_PATH}api/${isDevice ? 'devices' : 'rules'}/${id}`, dispatch, removeCookie);\r\n      window.$('#deletionDialog').modal('hide');\r\n    } catch (error) {\r\n      setData({ isLoading: false, errorMessage: `Error: ${error.message}` });\r\n    }\r\n  };\r\n\r\n  const addClicked = (isDevice) => {\r\n    history.push(`/add-${isDevice ? 'device' : 'rule'}`);\r\n  };\r\n\r\n  const cardClicked = (id) => {\r\n    setFlippedCard(flippedCard === id ? null : id);\r\n  };\r\n\r\n  const switchEntity = (id, name, state, isDevice) => {\r\n    setSwitchDisabled(true);\r\n    restPost(`${SERVER_PATH}api/${isDevice ? 'devices' : 'rules'}/${id}/switch-state`, { state }, dispatch, removeCookie).then(() => {\r\n      setSwitchDisabled(false);\r\n    })\r\n      .catch((error) => {\r\n        setMsgDialog(`Failed to ${isDevice ? `switch ${name}` : `${state ? 'enable' : 'disable'} ${name}`}: ${error.message}`);\r\n        window.$('#messageDialog').modal('show');\r\n      });\r\n  };\r\n\r\n  const editClicked = (e, id, isDevice) => {\r\n    e.stopPropagation();\r\n    history.push(`/${isDevice ? 'devices' : 'rules'}/${id}`);\r\n  };\r\n\r\n  const deleteClicked = (e, id, name, isDevice) => {\r\n    e.stopPropagation();\r\n    setDeletionDialog({\r\n      text: `Do you want to delete ${isDevice ? 'device' : 'rule'} ${name}?`,\r\n      btnHandler: () => deleteEntity(id, isDevice),\r\n      isLoading: false,\r\n      errorMessage: '',\r\n    });\r\n    window.$('#deletionDialog').modal('show');\r\n  };\r\n\r\n  if (pageError.message) {\r\n    return <ErrorPage status={pageError.status} message={pageError.message} />;\r\n  }\r\n\r\n  if (isLoading) {\r\n    return <LoadingPage />;\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <nav className=\"navbar navbar-light fixed-top mt-2 p-0 mr-2\" style={{ background: 'transparent' }}>\r\n        <span />\r\n        <span onClick={() => history.push('/statistics')} className=\"material-icons text-light text-light statIcon clickable float-right p-0 mr-2\">leaderboard</span>\r\n      </nav>\r\n    <div className=\"d-flex justify-content-center mt-4 text-center\">\r\n      <div style={{ width: 900 }}>\r\n        <h1 className=\"display-4 text-light\">Devices</h1>\r\n        <div className=\"d-flex justify-content-center flex-wrap mt-4\">\r\n          {devices.map(({\r\n            id, name, temperature, active,\r\n          }) => {\r\n            const classes = classNames({ flipCard: true, 'is-flipped': flippedCard !== id });\r\n            return (\r\n              <div key={id} className=\"flipDevice mx-2 mb-4 rounded-circle zoom\" >\r\n                <div className={classes}>\r\n                  <div onClick={() => cardClicked(id)} className=\"flipCard-front card text-center rounded-circle darkBg p-0 clickable shadow-sm deviceCard\">\r\n                    <div className=\"darkBg my-auto mx-3\">\r\n                      <div className=\"mx-1\">\r\n                        <button onClick={(e) => editClicked(e, id, true)} type=\"button\" className=\"btn btn-md btn-outline-light btn-block\">Edit</button>\r\n                        <button onClick={(e) => deleteClicked(e, id, name, true)} type=\"button\" className=\"btn btn btn-outline-danger btn-block\">Delete</button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div onClick={() => cardClicked(id)} className=\"flipCard-front flipCard-back card text-center rounded-circle darkBg p-3 clickable shadow-sm deviceCard\">\r\n                    <div className=\"darkBg my-auto mx-3\">\r\n                      <p className=\"mx-0 mt-0 mb-1 text-light sammy-nowrap-2\">{name}</p>\r\n                      <h2 className=\"card-title text-light\">{temperature ? `${temperature.toFixed(1)} °C` : 'N/A'}</h2>\r\n                      <div onClick={(e) => e.stopPropagation()} className=\"fancySwitch mt-3 mx-auto\">\r\n                        <input onChange={() => switchEntity(id, name, !active, true)} type=\"checkbox\" className=\"fancySwitch-checkbox\" id={`cb-${id}`} checked={active} disabled={switchDisabled}/>\r\n                        <label className=\"fancySwitch-label\" htmlFor={`cb-${id}`}/>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div onClick={() => addClicked(true)} className=\"card text-center rounded-circle darkBg p-0 clickable shadow-sm mx-2 mb-4 zoom deviceCard\">\r\n            <div className=\"darkBg my-auto mx-3\">\r\n              <span className=\"material-icons text-light text-muted addIcon\">add</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <h1 className=\"display-4 text-light mt-3\">Rules</h1>\r\n        <div className=\"d-flex justify-content-center flex-wrap mt-4\">\r\n          {rules.map((rule) => {\r\n            const {\r\n              id, name, startTime, endTime, minTemp, maxTemp, activated, enabled,\r\n            } = rule;\r\n            const classes = classNames({ flipCard: true, 'is-flipped': flippedCard !== id });\r\n            return (\r\n              <div key={id} className=\"flipRule mx-2 mb-4 rounded-lg zoom\" >\r\n                <div className={classes}>\r\n                  <div onClick={() => cardClicked(id)} className=\"flipCard-front card text-center rounded-lg darkBg p-0 clickable shadow-sm ruleCard\">\r\n                    <div className=\"darkBg my-auto mx-3\">\r\n                      <div className=\"mx-1\">\r\n                        <button onClick={(e) => editClicked(e, id, false)} type=\"button\" className=\"btn btn-md btn-outline-light btn-block\">Edit</button>\r\n                        <button onClick={(e) => deleteClicked(e, id, name, false)} type=\"button\" className=\"btn btn btn-outline-danger btn-block\">Delete</button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div onClick={() => cardClicked(id)} className=\"flipCard-front flipCard-back card text-center rounded-lg darkBg p-2 shadow-sm clickable ruleCard\" >\r\n                    <div className=\"darkBg my-auto\">\r\n                      <h4 className=\"text-light mb-0 sammy-nowrap-2\">{name}</h4>\r\n                      {activated ? <p className=\"primaryText\">ACTIVE</p> : <p className=\"primaryText text-muted\">INACTIVE</p>}\r\n                      <h5 className=\"text-light mt-4\">{timeToString(startTime)} · {timeToString(endTime)}</h5>\r\n                      <h5 className=\"text-light\">{minTemp.toFixed(1)} °C · {maxTemp.toFixed(1)} °C</h5>\r\n                      <p className=\"text-light text-muted mx-0 mb-0 mt-3\">Measure:</p>\r\n                      <h5 className=\"text-light mt-0 sammy-nowrap-2\">{rule.measuringDevice.name}</h5>\r\n                      <p className=\"text-light text-muted mx-0 mb-0 mt-3\">Controlled:</p>\r\n                      <h5 className=\"text-light mt-0 sammy-nowrap-2\">{rule.controlDevice.name}</h5>\r\n                      <div onClick={(e) => e.stopPropagation()} className=\"fancySwitch mx-auto mt-4\">\r\n                        <input onChange={() => switchEntity(id, name, !enabled, false)} type=\"checkbox\" className=\"fancySwitch-checkbox\" id={`cb-${id}`} checked={enabled} disabled={switchDisabled}/>\r\n                        <label className=\"fancySwitch-label\" htmlFor={`cb-${id}`} />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n          <div onClick={() => addClicked(false)} className=\"card text-center rounded-lg darkBg p-0 clickable shadow-sm mx-2 mb-4 zoom ruleCard\">\r\n            <div className=\"darkBg my-auto mx-3\">\r\n              <span className=\"material-icons text-light text-muted addIcon\">add</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <ConfirmationDialog id=\"deletionDialog\"\r\n                            text={deletionDialog.text}\r\n                            btnText=\"Delete\"\r\n                            btnType=\"danger\"\r\n                            btnHandler={deletionDialog.btnHandler}\r\n                            isLoading={deletionDialog.isLoading}\r\n                            errorMessage={deletionDialog.errorMessage}/>\r\n        <MessageDialog id=\"messageDialog\" text={msgDialog}/>\r\n      </div>\r\n    </div>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n","const required = { allowEmpty: false, message: 'This field is required.' };\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const deviceConstraints = {\r\n  name: {\r\n    presence: required,\r\n    length: {\r\n      minimum: 3,\r\n      maximum: 16,\r\n      tooShort: 'The name must be between 3 and 16 characters.',\r\n      tooLong: 'The name must be between 3 and 16 characters.',\r\n    },\r\n    format: {\r\n      pattern: '\\\\p{L}+',\r\n      flags: 'u',\r\n      message: 'The name must only contain alphabetical characters.',\r\n    },\r\n  },\r\n  id: {\r\n    presence: required,\r\n    length: {\r\n      minimum: 3,\r\n      maximum: 16,\r\n      tooShort: 'The id must be between 3 and 16 characters.',\r\n      tooLong: 'The id must be between 3 and 16 characters.',\r\n    },\r\n    format: {\r\n      pattern: '[A-Za-z0-9]+',\r\n      flags: 'u',\r\n      message: 'The ID must only contain alphanumerical characters.',\r\n    },\r\n  },\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useCookies } from 'react-cookie';\r\nimport { deviceConstraints as rules } from '../constraints/deviceConstraints';\r\nimport { restGet, restPut, restPost } from '../utils/communication';\r\nimport { Input, trimDecorator } from './form_utils.jsx';\r\nimport ErrorPage from './error_page.jsx';\r\nimport LoadingPage from './loading_page.jsx';\r\nimport { SERVER_PATH } from '../constants';\r\nimport { needToLoad } from '../actions/deviceActions';\r\n\r\nconst validate = require('validate.js');\r\n\r\nconst DeviceForm = (prop) => {\r\n  const { isEdit } = prop;\r\n\r\n  const editId = (useParams()).id;\r\n\r\n  const [deviceName, setDeviceName] = useState({ value: '', error: '' });\r\n  const [deviceId, setDeviceId] = useState({ value: '', error: '' });\r\n  const [isMeasuring, setMeasuring] = useState(true);\r\n  const [formDisabled, setFormDisabled] = useState(false);\r\n  const [formError, setFormError] = useState('');\r\n\r\n  const [pageError, setPageError] = useState({});\r\n  const [isLoading, setLoading] = useState(false);\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const cookies = useCookies();\r\n  const removeCookie = cookies[2];\r\n\r\n  const setterDict = { name: setDeviceName, id: setDeviceId };\r\n\r\n  useEffect(() => {\r\n    document.title = `${isEdit ? 'Edit' : 'Add'} device`;\r\n  }, [isEdit]);\r\n\r\n  useEffect(() => {\r\n    if (isEdit) {\r\n      setLoading(true);\r\n      restGet(`${SERVER_PATH}api/devices/${editId}`, dispatch, removeCookie).then((result) => {\r\n        const setData = (setter, value) => setter((rest) => ({ ...rest, value }));\r\n        setData(setDeviceName, result.name);\r\n        setData(setDeviceId, result.deviceId);\r\n        setMeasuring(result.measuring);\r\n        setLoading(false);\r\n      }).catch((error) => {\r\n        setPageError(error);\r\n        setLoading(false);\r\n      });\r\n    }\r\n  }, [isEdit, editId, dispatch, removeCookie]);\r\n\r\n  const backToDashboard = () => {\r\n    history.replace('/');\r\n  };\r\n\r\n  const submitForm = (event) => {\r\n    event.preventDefault();\r\n    setFormError('');\r\n    const evaluateInputErrors = (errors) => {\r\n      Object.entries(errors).forEach(([key, value]) => {\r\n        setterDict[key]((rest) => ({ ...rest, error: value[0] }));\r\n      });\r\n    };\r\n\r\n    const validation = validate({\r\n      name: deviceName.value,\r\n      id: deviceId.value,\r\n    }, rules, { fullMessages: false });\r\n\r\n    if (validation) {\r\n      evaluateInputErrors(validation);\r\n    } else {\r\n      setFormDisabled(true);\r\n      const body = { name: deviceName.value, deviceId: deviceId.value, isMeasuring };\r\n      let methodFunc;\r\n      if (isEdit) {\r\n        body.id = editId;\r\n        methodFunc = restPost;\r\n      } else {\r\n        methodFunc = restPut;\r\n      }\r\n\r\n      methodFunc(`${SERVER_PATH}api/devices`, body, dispatch, removeCookie).then(() => {\r\n        dispatch(needToLoad());\r\n        backToDashboard();\r\n      })\r\n        .catch((error) => {\r\n          setFormDisabled(false);\r\n          if (error.inputErrors) {\r\n            evaluateInputErrors(error.inputErrors);\r\n          } else {\r\n            setFormError(`Error: ${error.message}`);\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  if (pageError.message) {\r\n    return <ErrorPage status={pageError.status} message={pageError.message} />;\r\n  }\r\n\r\n  if (isLoading) {\r\n    return <LoadingPage />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex justify-content-center mb-4 mx-2\">\r\n      <div style={{ width: 500 }}>\r\n        <h1 className=\"display-4 text-light mt-4 text-center\">{isEdit ? 'Edit' : 'Add'} device</h1>\r\n        <form onSubmit={submitForm} className=\"mt-5\">\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"text\"\r\n                     id=\"inputDeviceName\"\r\n                     label=\"Device name\"\r\n                     state={deviceName}\r\n                     setState={setDeviceName}\r\n                     constraint={{ value: rules.name }}\r\n                     decorators={[trimDecorator]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"text\"\r\n                     id=\"inputDeviceId\"\r\n                     label=\"Device ID\"\r\n                     state={deviceId}\r\n                     setState={setDeviceId}\r\n                     constraint={{ value: rules.id }}\r\n                     decorators={[trimDecorator]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <p className=\"text-light text-center mb-2\">Measuring device</p>\r\n            <div onClick={(e) => e.stopPropagation()} className=\"fancySwitch m-auto\">\r\n              <input onChange={() => setMeasuring(!isMeasuring)} type=\"checkbox\" className=\"fancySwitch-checkbox\" id=\"mes\" checked={isMeasuring} disabled={formDisabled}/>\r\n              <label className=\"fancySwitch-label\" htmlFor=\"mes\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex justify-content-center mt-5\">\r\n            <div>\r\n              <button type=\"submit\" className=\"btn btn-light\" disabled={formDisabled}>\r\n                {formDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                {isEdit ? 'Edit' : 'Add'} device\r\n              </button>\r\n              <button onClick={backToDashboard} type=\"button\" className=\"btn btn-outline-light ml-2\" disabled={formDisabled}>Cancel</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n        {formError && <div className=\"alert alert-danger mt-5\" role=\"alert\">{formError}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DeviceForm;\r\n","const required = { allowEmpty: false, message: 'This field is required.' };\r\nconst time = {\r\n  presence: required,\r\n  format: {\r\n    pattern: '([0-1]?[0-9]|2[0-3]):[0-5][0-9]',\r\n    message: 'Enter a valid time',\r\n  },\r\n};\r\nconst device = {\r\n  presence: required,\r\n  selector: true,\r\n};\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const ruleConstraints = {\r\n  name: {\r\n    presence: required,\r\n    length: {\r\n      minimum: 3,\r\n      maximum: 16,\r\n      tooShort: 'The name must be between 3 and 16 characters.',\r\n      tooLong: 'The name must be between 3 and 16 characters.',\r\n    },\r\n    format: {\r\n      pattern: '\\\\p{L}+',\r\n      flags: 'u',\r\n      message: 'The name must only contain alphabetical characters.',\r\n    },\r\n  },\r\n  startTime: time,\r\n  endTime: time,\r\n  minTemp: {\r\n    presence: required,\r\n    numericality: {\r\n      message: 'Enter a valid number.',\r\n    },\r\n  },\r\n  maxTemp: {\r\n    presence: required,\r\n    numericality: {\r\n      message: 'Enter a valid number.',\r\n    },\r\n    tempCompare: true,\r\n\r\n  },\r\n  measuringDevice: device,\r\n  controlDevice: device,\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useCookies } from 'react-cookie';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport {\r\n  Input, roundDecorator, SelectInput, trimDecorator,\r\n} from './form_utils.jsx';\r\nimport ErrorPage from './error_page.jsx';\r\nimport LoadingPage from './loading_page.jsx';\r\nimport { ruleConstraints as rules } from '../constraints/ruleConstraints';\r\nimport { restGet, restPost, restPut } from '../utils/communication';\r\nimport { SERVER_PATH } from '../constants';\r\nimport { needToLoad } from '../actions/deviceActions';\r\n\r\nconst validate = require('validate.js');\r\n\r\nconst RuleForm = (prop) => {\r\n  const { isEdit } = prop;\r\n\r\n  const editId = (useParams()).id;\r\n\r\n  const [ruleName, setRuleName] = useState({ value: '', error: '' });\r\n  const [startTime, setStartTime] = useState({ value: '', error: '' });\r\n  const [endTime, setEndTime] = useState({ value: '', error: '' });\r\n  const [minTemp, setMinTemp] = useState({ value: '', error: '' });\r\n  const [maxTemp, setMaxTemp] = useState({ value: '', error: '' });\r\n  const [measuringDevice, setMeasuringDevice] = useState({ options: [], selectedId: null, error: '' });\r\n  const [controlDevice, setControlDevice] = useState({ options: [], selectedId: null, error: '' });\r\n\r\n  const [formDisabled, setFormDisabled] = useState(false);\r\n  const [formError, setFormError] = useState('');\r\n\r\n  const [pageError, setPageError] = useState({});\r\n  const [isLoading, setLoading] = useState(false);\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const cookies = useCookies();\r\n  const removeCookie = cookies[2];\r\n\r\n  useEffect(() => {\r\n    document.title = `${isEdit ? 'Edit' : 'Add'} rule`;\r\n  }, [isEdit]);\r\n\r\n  useEffect(() => {\r\n    const pad = (num) => (num < 10 ? `0${num}` : num);\r\n    const timeToString = (time) => `${pad(Math.trunc(time / 60))}:${pad(time % 60)}`;\r\n    (async () => {\r\n      try {\r\n        const devices = await restGet(`${SERVER_PATH}api/devices`, dispatch, removeCookie);\r\n        const setData = (setter, options) => setter((rest) => ({ ...rest, options }));\r\n        setData(setMeasuringDevice, devices\r\n          .filter((device) => device.measuring === true)\r\n          .map((item) => ({ id: item.id, name: item.name })));\r\n        setData(setControlDevice, devices.map((item) => ({ id: item.id, name: item.name })));\r\n        if (isEdit) {\r\n          const rule = await restGet(`${SERVER_PATH}api/rules/${editId}`, dispatch, removeCookie);\r\n          const setRuleData = (setter, value) => setter((rest) => ({ ...rest, value }));\r\n          const setSelectorId = (setter, selectedId) => setter((rest) => ({ ...rest, selectedId }));\r\n          setRuleData(setRuleName, rule.name);\r\n          setRuleData(setStartTime, timeToString(rule.startTime));\r\n          setRuleData(setEndTime, timeToString(rule.endTime));\r\n          setRuleData(setMinTemp, rule.minTemp);\r\n          setRuleData(setMaxTemp, rule.maxTemp);\r\n          setSelectorId(setMeasuringDevice, rule.measuringDevice);\r\n          setSelectorId(setControlDevice, rule.controlDevice);\r\n        }\r\n        setLoading(false);\r\n      } catch (error) {\r\n        setPageError(error);\r\n        setLoading(false);\r\n      }\r\n    })();\r\n    setLoading(true);\r\n  }, [removeCookie, dispatch, editId, isEdit]);\r\n\r\n  const setterDict = {\r\n    name: setRuleName,\r\n    startTime: setStartTime,\r\n    endTime: setEndTime,\r\n    minTemp: setMinTemp,\r\n    maxTemp: setMaxTemp,\r\n    measuringDevice: setMeasuringDevice,\r\n    controlDevice: setControlDevice,\r\n  };\r\n\r\n  validate.validators.selector = (value) => {\r\n    if (!value) {\r\n      return 'This field is required.';\r\n    }\r\n    return undefined;\r\n  };\r\n\r\n  validate.validators.tempCompare = (value) => {\r\n    const min = parseFloat(minTemp.value);\r\n    const max = parseFloat(value);\r\n    if (Number.isNaN(min) || Number.isNaN(max)) {\r\n      return undefined;\r\n    }\r\n    if (max < min) {\r\n      return 'Maximum temperature must be greater than or equal to minimum temperature.';\r\n    }\r\n    return undefined;\r\n  };\r\n\r\n  const backToDashboard = () => {\r\n    history.replace('/');\r\n  };\r\n\r\n  const submitForm = (event) => {\r\n    event.preventDefault();\r\n    setFormError('');\r\n    const evaluateInputErrors = (errors) => {\r\n      Object.entries(errors).forEach(([key, value]) => {\r\n        setterDict[key]((rest) => ({ ...rest, error: value[0] }));\r\n      });\r\n    };\r\n\r\n    const body = {\r\n      name: ruleName.value,\r\n      startTime: startTime.value,\r\n      endTime: endTime.value,\r\n      minTemp: minTemp.value,\r\n      maxTemp: maxTemp.value,\r\n      measuringDevice: measuringDevice.selectedId,\r\n      controlDevice: controlDevice.selectedId,\r\n    };\r\n\r\n    const validation = validate(body, rules, { fullMessages: false });\r\n    if (validation) {\r\n      evaluateInputErrors(validation);\r\n    } else {\r\n      setFormDisabled(true);\r\n      body.minTemp = Math.round(parseFloat(body.minTemp) * 10) / 10;\r\n      body.maxTemp = Math.round(parseFloat(body.maxTemp) * 10) / 10;\r\n      let methodFunc;\r\n      if (isEdit) {\r\n        body.id = editId;\r\n        methodFunc = restPost;\r\n      } else {\r\n        methodFunc = restPut;\r\n      }\r\n\r\n      methodFunc(`${SERVER_PATH}api/rules`, body, dispatch, removeCookie).then(() => {\r\n        dispatch(needToLoad());\r\n        backToDashboard();\r\n      })\r\n        .catch((error) => {\r\n          setFormDisabled(false);\r\n          if (error.inputErrors) {\r\n            evaluateInputErrors(error.inputErrors);\r\n          } else {\r\n            setFormError(`Error: ${error.message}`);\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  if (pageError.message) {\r\n    return <ErrorPage status={pageError.status} message={pageError.message} />;\r\n  }\r\n\r\n  if (isLoading) {\r\n    return <LoadingPage />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex justify-content-center mb-4 mx-2\">\r\n      <div style={{ width: 500 }}>\r\n        <h1 className=\"display-4 text-light mt-4 text-center\">{isEdit ? 'Edit' : 'Add'} rule</h1>\r\n        <form onSubmit={submitForm} className=\"mt-5\">\r\n          <div className=\"form-group\">\r\n            <Input type=\"text\"\r\n                   id=\"inputRuleName\"\r\n                   label=\"Rule name\"\r\n                   state={ruleName}\r\n                   setState={setRuleName}\r\n                   constraint={{ value: rules.name }}\r\n                   decorators={[trimDecorator]}\r\n                   disabled={formDisabled} />\r\n          </div>\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"time\"\r\n                     id=\"inputStartTime\"\r\n                     label=\"Start time\"\r\n                     state={startTime}\r\n                     setState={setStartTime}\r\n                     constraint={{ value: rules.startTime }}\r\n                     decorators={[]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"time\"\r\n                     id=\"inputEndTime\"\r\n                     label=\"End time\"\r\n                     state={endTime}\r\n                     setState={setEndTime}\r\n                     constraint={{ value: rules.endTime }}\r\n                     decorators={[]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n          </div>\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"number\"\r\n                     id=\"inputMinTemp\"\r\n                     label=\"Minimum temperature\"\r\n                     state={minTemp}\r\n                     setState={setMinTemp}\r\n                     constraint={{ value: rules.minTemp }}\r\n                     decorators={[roundDecorator]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-group col-md-6\">\r\n              <Input type=\"number\"\r\n                     id=\"inputMaxTemp\"\r\n                     label=\"Maximum temperature\"\r\n                     state={maxTemp}\r\n                     setState={setMaxTemp}\r\n                     constraint={{ value: rules.maxTemp }}\r\n                     decorators={[roundDecorator]}\r\n                     disabled={formDisabled} />\r\n            </div>\r\n          </div>\r\n          <div className=\"form-row\">\r\n            <div className=\"form-group col-md-6\">\r\n              <SelectInput id=\"inputMeasureDevice\"\r\n                           label=\"Measuring device\"\r\n                           state={measuringDevice}\r\n                           setState={setMeasuringDevice}\r\n                           constraint={{ value: rules.measuringDevice }}\r\n                           disabled={formDisabled} />\r\n            </div>\r\n            <div className=\"form-group col-md-6\">\r\n              <SelectInput id=\"inputControlDevice\"\r\n                           label=\"Controlled device\"\r\n                           state={controlDevice}\r\n                           setState={setControlDevice}\r\n                           constraint={{ value: rules.controlDevice }}\r\n                           disabled={formDisabled} />\r\n            </div>\r\n          </div>\r\n          <div className=\"d-flex justify-content-center mt-5\">\r\n            <div>\r\n              <button type=\"submit\" className=\"btn btn-light\" disabled={formDisabled}>\r\n                {formDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                {isEdit ? 'Edit' : 'Add'} rule\r\n              </button>\r\n              <button onClick={backToDashboard} type=\"button\" className=\"btn btn-outline-light ml-2\" disabled={formDisabled}>Cancel</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n        {formError && <div className=\"alert alert-danger mt-5\" role=\"alert\">{formError}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RuleForm;\r\n","import { actionLoadStatistics } from './actionTypes';\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const loadStatistics = (payload) => ({ type: actionLoadStatistics, payload });\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Chart } from 'react-google-charts';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useCookies } from 'react-cookie';\r\nimport socketIOClient from 'socket.io-client';\r\nimport { restGet } from '../utils/communication';\r\nimport { SERVER_PATH } from '../constants';\r\nimport { loadStatistics } from '../actions/statisticActions';\r\nimport { Input, SelectInput } from './form_utils.jsx';\r\n\r\nconst moment = require('moment');\r\nconst validate = require('validate.js');\r\n\r\nconst Statistics = () => {\r\n  const devices = useSelector((state) => state.statistics.devices);\r\n  const [socketUpdate, setSocketUpdate] = useState(null);\r\n  const [lastTime, setLastTime] = useState(3600000 * 6);\r\n\r\n  const [lastFormDisabled, setLastFormDisabled] = useState(false);\r\n  const [lastFormError, setLastFormError] = useState('');\r\n  const [quantity, setQuantity] = useState({ value: '6', error: '' });\r\n  const [unit, setUnit] = useState({\r\n    options: [\r\n      { id: 'hours', name: 'hours' },\r\n      { id: 'days', name: 'days' },\r\n      { id: 'weeks', name: 'weeks' },\r\n      { id: 'months', name: 'months' },\r\n      { id: 'years', name: 'years' },\r\n    ],\r\n    selectedId: 'hours',\r\n    error: '',\r\n  });\r\n\r\n  const [intervalFormDisabled, setIntervalFormDisabled] = useState(false);\r\n  const [intervalFormError, setIntervalFormError] = useState('');\r\n  const [firstDate, setFirstDate] = useState({ value: '', time: '', error: '' });\r\n  const [lastDate, setLastDate] = useState({ value: '', time: '', error: '' });\r\n\r\n  const [isInter, setInter] = useState(false);\r\n\r\n  const [socket, setSocket] = useState(null);\r\n\r\n  const dispatch = useDispatch();\r\n  const cookies = useCookies();\r\n  const removeCookie = cookies[2];\r\n  const history = useHistory();\r\n\r\n  const offset = (new Date()).getTimezoneOffset() * 60000;\r\n\r\n  const setterDict = {\r\n    firstDate: setFirstDate,\r\n    lastDate: setLastDate,\r\n    quantity: setQuantity,\r\n    unit: setUnit,\r\n  };\r\n\r\n  const required = { allowEmpty: false, message: 'This field is required.' };\r\n  const constraints = {\r\n    lastConstraint: {\r\n      quantity: {\r\n        presence: required,\r\n      },\r\n      unit: {\r\n        presence: required,\r\n        selector: true,\r\n      },\r\n    },\r\n    intervalConstraint: {\r\n      firstDate: {\r\n        presence: required,\r\n        validDate: true,\r\n      },\r\n      lastDate: {\r\n        presence: required,\r\n        validDate: true,\r\n        dateDiff: true,\r\n      },\r\n    },\r\n  };\r\n\r\n  validate.validators.selector = (value) => {\r\n    if (!value) {\r\n      return 'This field is required.';\r\n    }\r\n    return undefined;\r\n  };\r\n\r\n  validate.validators.validDate = (value) => {\r\n    if ((moment(new Date(value))).isValid()) {\r\n      return undefined;\r\n    }\r\n    return 'Enter a valid date.';\r\n  };\r\n\r\n  validate.validators.dateDiff = (value) => {\r\n    if ((new Date(value)).getTime() >= (new Date(firstDate.value)).getTime()) {\r\n      return undefined;\r\n    }\r\n    return 'Last date must be larger or equal than first date.';\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.title = 'Statistics';\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    restGet(`${SERVER_PATH}api/temperatures?lastTime=${3600000 * 6}`, dispatch, removeCookie).then((result) => {\r\n      dispatch(loadStatistics(result));\r\n    }).catch((error) => {\r\n      console.log(`Error: ${error.message}`);\r\n    });\r\n  }, [dispatch, removeCookie]);\r\n\r\n  useEffect(() => {\r\n    const so = socketIOClient(window.location.hostname);\r\n    setSocket(so);\r\n    return () => {\r\n      so.disconnect();\r\n      setSocket(null);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('temperature update', (payload) => {\r\n        setSocketUpdate(payload);\r\n      });\r\n    }\r\n  }, [dispatch, socket]);\r\n\r\n  useEffect(() => {\r\n    if (socketUpdate !== null) {\r\n      const newList = devices.map((item) => {\r\n        if (item.id !== socketUpdate.deviceId) {\r\n          return item;\r\n        }\r\n        let temperatures = [...(item.temperatures)];\r\n        temperatures.push(socketUpdate.temperature);\r\n        if (isInter) {\r\n          temperatures = temperatures.filter(\r\n            (temp) => temp[0] >= (new Date(firstDate.value)).getTime()\r\n              && temp[0] < (new Date(lastDate.value)).getTime() + 86400000,\r\n          );\r\n        } else {\r\n          const currentTime = (new Date()).getTime();\r\n          temperatures = temperatures.filter((temp) => currentTime - temp[0] <= lastTime);\r\n        }\r\n        return { id: item.id, name: item.name, temperatures };\r\n      });\r\n      dispatch(loadStatistics(newList));\r\n      setSocketUpdate(null);\r\n    }\r\n  }, [devices, dispatch, firstDate.value, isInter, lastDate.value, lastTime, socketUpdate]);\r\n\r\n  const applyClicked = (isInterval) => {\r\n    setInter(isInterval);\r\n    const evaluateInputErrors = (errors) => {\r\n      Object.entries(errors).forEach(([key, value]) => {\r\n        setterDict[key]((rest) => ({ ...rest, error: value[0] }));\r\n      });\r\n    };\r\n    const setFormDisabled = isInterval ? setIntervalFormDisabled : setLastFormDisabled;\r\n    const setFormError = isInterval ? setIntervalFormError : setLastFormError;\r\n    const update = (a, b) => {\r\n      setFormError('');\r\n      setFormDisabled(true);\r\n      const query = !isInterval ? `lastTime=${a}` : `firstDate=${a + offset}&lastDate=${b + offset}`;\r\n      restGet(`${SERVER_PATH}api/temperatures?${query}`, dispatch, removeCookie).then((result) => {\r\n        dispatch(loadStatistics(result));\r\n        setFormDisabled(false);\r\n      }).catch((error) => {\r\n        if (error.inputErrors) {\r\n          evaluateInputErrors(error.inputErrors);\r\n        } else {\r\n          setFormError(`Error: ${error.message}`);\r\n        }\r\n        setFormDisabled(false);\r\n      });\r\n    };\r\n\r\n    if (isInterval) {\r\n      const body = {\r\n        firstDate: firstDate.value,\r\n        lastDate: lastDate.value,\r\n      };\r\n      const validation = validate(body, constraints.intervalConstraint, { fullMessages: false });\r\n      if (validation) {\r\n        evaluateInputErrors(validation);\r\n      } else {\r\n        const getNum = (time) => (new Date(time)).getTime();\r\n        const setDate = (date, setter) => setter(\r\n          (rest) => ({ ...rest, time: getNum(date) }),\r\n        );\r\n        setDate(firstDate.value, setFirstDate);\r\n        setDate(lastDate.value, setLastDate);\r\n        update(getNum(firstDate.value), getNum(lastDate.value));\r\n      }\r\n    } else {\r\n      const body = {\r\n        quantity: quantity.value,\r\n        unit: unit.selectedId,\r\n      };\r\n\r\n      const validation = validate(body, constraints.lastConstraint, { fullMessages: false });\r\n      if (validation) {\r\n        evaluateInputErrors(validation);\r\n      } else {\r\n        const n = parseInt(quantity.value, 10);\r\n        if (!Number.isNaN(n)) {\r\n          const getMultiplier = () => {\r\n            switch (unit.selectedId) {\r\n              case 'hours': default: return 3600000;\r\n              case 'days': return 86400000;\r\n              case 'weeks': return 604800000;\r\n              case 'months': return 2630016000;\r\n              case 'years': return 31556952000;\r\n            }\r\n          };\r\n          const sum = n * getMultiplier();\r\n          setLastTime(sum);\r\n          update(sum);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const downloadFile = (deviceId, name, type) => {\r\n    const objToText = (content) => JSON.stringify(content, null, 2);\r\n    let content = devices.map(\r\n      (device) => ({\r\n        id: device.id,\r\n        name: device.name,\r\n        temperatures: device.temperatures.map((item) => [new Date(item[0]), item[1]]),\r\n        states: device.states.map((item) => [new Date(item[0]), item[1]]),\r\n      }),\r\n    ).find((device) => device.id === deviceId);\r\n    let fileName = isInter\r\n      ? `${name}_between_${(moment(firstDate.time)).format('YYYY-MM-DD')}_${(moment(lastDate.time)).format('YYYY-MM-DD')}`\r\n      : `${name}_${(moment()).format('YYYY-MM-DD_HH-mm')}_last_${Math.floor(lastTime / 3600000)}_hours`;\r\n    switch (type) {\r\n      case 'json':\r\n        content = objToText(content);\r\n        fileName = `${fileName}.json`;\r\n        break;\r\n      case 'txt':\r\n        content = objToText(content);\r\n        fileName = `${fileName}.txt`;\r\n        break;\r\n      default:\r\n        content = objToText(content);\r\n        fileName = `${fileName}.json`;\r\n        break;\r\n    }\r\n\r\n    const element = document.createElement('a');\r\n    element.href = URL.createObjectURL(new Blob([content], { type: 'text/plain' }));\r\n    element.download = fileName;\r\n    document.body.appendChild(element);\r\n    element.click();\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <nav className=\"navbar navbar-light fixed-top mt-2 p-0 mr-2\" style={{ background: 'transparent' }}>\r\n        <span />\r\n        <span onClick={() => history.replace('/')} className=\"material-icons text-light text-light statIcon clickable float-right p-0 mr-2\">dashboard</span>\r\n      </nav>\r\n    <h1 className=\"display-4 text-light mt-4 mb-4 text-center\">Statistics</h1>\r\n    <div className=\"d-flex justify-content-center\">\r\n      <div style={{ width: 900, maxWidth: 900 }}>\r\n        <form className=\"mx-2\">\r\n          <div className=\"d-flex justify-content-center flex-wrap\">\r\n              <div className=\"card darkBg rounded-lg shadow-sm mx-2 my-2 col-md-4\">\r\n                <div className=\"card-body px-0\">\r\n                  <h4 className=\"card-title text-light text-center mb-3\">The last</h4>\r\n                  <div className=\"form-row mr-2\">\r\n                    <div className=\"form-group col-md-6\">\r\n                      <Input type=\"number\"\r\n                             id=\"inputQuantity\"\r\n                             label=\"Quantity\"\r\n                             constraint={{ value: constraints.lastConstraint.quantity }}\r\n                             disabled={lastFormDisabled}\r\n                             state={quantity}\r\n                             setState={setQuantity}/>\r\n                    </div>\r\n                    <div className=\"form-group col-md-6\">\r\n                      <SelectInput id=\"inputUnit\"\r\n                                   label=\"Unit\"\r\n                                   constraint={{ value: constraints.lastConstraint.unit }}\r\n                                   disabled={lastFormDisabled}\r\n                                   state={unit}\r\n                                   setState={setUnit} />\r\n                    </div>\r\n                    <button onClick={() => applyClicked(false)} type=\"button\" className=\"btn btn-outline-light mx-auto\" disabled={lastFormDisabled}>\r\n                      {lastFormDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                      Apply\r\n                    </button>\r\n                  </div>\r\n                  {lastFormError && <div className=\"alert alert-danger mt-3\" role=\"alert\">{lastFormError}</div>}\r\n                </div>\r\n              </div>\r\n            <div className=\"card darkBg rounded-lg shadow-sm mx-2 my-2 col-md-7\">\r\n              <div className=\"card-body px-0\">\r\n                <h4 className=\"card-title text-light text-center mb-3\">Interval</h4>\r\n              <div className=\"form-row\">\r\n                <div className=\"form-group col-md-6\">\r\n                  <Input type=\"date\"\r\n                         id=\"inputFirstDate\"\r\n                         label=\"First date\"\r\n                         constraint={{ value: constraints.intervalConstraint.firstDate }}\r\n                         disabled={intervalFormDisabled}\r\n                         state={firstDate}\r\n                         setState={setFirstDate} />\r\n                </div>\r\n                <div className=\"form-group col-md-6\">\r\n                  <Input type=\"date\"\r\n                         id=\"inputLastDate\"\r\n                         label=\"Last date\"\r\n                         constraint={{ value: constraints.intervalConstraint.lastDate }}\r\n                         disabled={intervalFormDisabled}\r\n                         state={lastDate}\r\n                         setState={setLastDate} />\r\n                </div>\r\n                <button onClick={() => applyClicked(true)} type=\"button\" className=\"btn btn-outline-light mx-auto\" disabled={intervalFormDisabled}>\r\n                  {intervalFormDisabled && <span className=\"spinner-border spinner-border-sm mr-2\" role=\"status\" aria-hidden=\"true\" />}\r\n                  Apply\r\n                </button>\r\n              </div>\r\n                {intervalFormError && <div className=\"alert alert-danger mt-3\" role=\"alert\">{intervalFormError}</div>}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      <div className=\"d-flex justify-content-center flex-wrap mt-2 text-center\">\r\n        {devices.length > 0 && devices.map((device) => (\r\n            <div key={device.id} className=\"card rounded-lg darkBg p-0 clickable shadow-sm mt-4 mx-2\" style={{ width: 400, maxWidth: 400, height: 300 }}>\r\n              <div className=\"darkBg mx-3 mb-4 mt-4\">\r\n                <h4 className=\"text-light m-0 p-0 mb-2 font-weight-bold\" style={{ fontSize: 20 }}>\r\n                  {device.name}\r\n                  <div className=\"btn-group ml-2\" role=\"group\">\r\n                    <button id=\"downloadGroup\" type=\"button\" className=\"btn btn-sm btn-outline-light dropdown-toggle\"\r\n                            data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n                      Download\r\n                    </button>\r\n                    <div className=\"dropdown-menu\" aria-labelledby=\"downloadGroup\">\r\n                      <button type=\"button\" className=\"btn btn-sm btn-link dropdown-item\" onClick={() => downloadFile(device.id, device.name, 'json')}>json</button>\r\n                      <button type=\"button\" className=\"btn btn-sm btn-link dropdown-item\" onClick={() => downloadFile(device.id, device.name, 'txt')}>txt</button>\r\n                    </div>\r\n                  </div>\r\n                </h4>\r\n                {device.temperatures.length > 0 ? (\r\n                  <Chart\r\n                    width={'100%'}\r\n                    height={'200px'}\r\n                    chartType=\"LineChart\"\r\n                    loader={<div>Kecske</div>}\r\n                    data={[\r\n                      ['x', 'temperature'],\r\n                      ...(device.temperatures.map((temp) => [new Date(temp[0]), temp[1]])),\r\n                    ]}\r\n                    options={{\r\n                      backgroundColor: {\r\n                        fill: 'transparent',\r\n                      },\r\n                      hAxis: {\r\n                        gridlines: {\r\n                          color: 'transparent',\r\n                        },\r\n                        textStyle: {\r\n                          color: 'white',\r\n                        },\r\n                        units: {\r\n                          days: { format: ['MMM dd'] },\r\n                          hours: { format: ['HH:mm', 'ha'] },\r\n                        },\r\n                      },\r\n                      vAxis: {\r\n                        gridlines: {\r\n                          color: '#404142',\r\n                        },\r\n                        baselineColor: '#242526',\r\n                        textStyle: {\r\n                          color: 'white',\r\n                        },\r\n                      },\r\n                      legend: { position: 'none' },\r\n                      chartArea: {\r\n                        width: '80%',\r\n                        height: '80%',\r\n                      },\r\n                      colors: ['#80DEEA'],\r\n                    }}\r\n                    rootProps={{ 'data-testid': '1' }}\r\n                  />\r\n                ) : (\r\n                  <p className=\"text-light text-muted\">No data</p>\r\n                )}\r\n              </div>\r\n            </div>\r\n        ))}\r\n      </div>\r\n      </div>\r\n    </div>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Statistics;\r\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { useCookies } from 'react-cookie';\nimport {\n  BrowserRouter as Router, Route, Switch, Redirect,\n} from 'react-router-dom';\nimport Login from './components/login.jsx';\nimport Dashboard from './components/dashboard.jsx';\nimport DeviceForm from './components/device_form.jsx';\nimport RuleForm from './components/rule_form.jsx';\nimport ErrorPage from './components/error_page.jsx';\nimport { APP_URL_PATH } from './constants';\nimport Statistics from './components/statistics.jsx';\n\nconst App = () => {\n  const loggedIn = useSelector((state) => state.user.loggedIn);\n\n  const PrivateRoute = (input) => {\n    const { children, ...rest } = input;\n    const [cookie] = useCookies(['loggedin']);\n    return <Route {...rest} render={() => ((cookie.loggedin === '1' || loggedIn) ? (children) : (<Redirect to={{ pathname: `${APP_URL_PATH}login` }} />))} />;\n  };\n\n  const PublicRoute = (input) => {\n    const { children, ...rest } = input;\n    return <Route {...rest} render={() => (loggedIn ? (<Redirect to={{ pathname: `${APP_URL_PATH}` }} />) : (children))} />;\n  };\n\n  return (\n    <Router>\n      <Switch>\n        <PublicRoute path={`${APP_URL_PATH}login`}>\n          <Login />\n        </PublicRoute>\n        <PrivateRoute path={`${APP_URL_PATH}statistics`}>\n          <Statistics />\n        </PrivateRoute>\n        <PrivateRoute path={`${APP_URL_PATH}add-device`}>\n          <DeviceForm isEdit={false}/>\n        </PrivateRoute>\n        <PrivateRoute path={`${APP_URL_PATH}add-rule`}>\n          <RuleForm isEdit={false}/>\n        </PrivateRoute>\n        <PrivateRoute path={`${APP_URL_PATH}devices/:id`}>\n          <DeviceForm isEdit={true}/>\n        </PrivateRoute>\n        <PrivateRoute path={`${APP_URL_PATH}rules/:id`}>\n          <RuleForm isEdit={true}/>\n        </PrivateRoute>\n        <PrivateRoute exact path={`${APP_URL_PATH}`}>\n          <Dashboard />\n        </PrivateRoute>\n        <PublicRoute path=\"*\">\n          <ErrorPage status={404} message=\"Not found.\" />\n        </PublicRoute>\n      </Switch>\n    </Router>\n  );\n};\n\nexport default App;\n","import produce from 'immer';\r\nimport { actionLogIn, actionLogOut } from '../actions/actionTypes';\r\n\r\nconst defaultState = {\r\n  loggedIn: false,\r\n};\r\n\r\nconst userReducer = (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case actionLogIn:\r\n      return produce(state, (draft) => {\r\n        draft.loggedIn = true;\r\n      });\r\n    case actionLogOut:\r\n      return defaultState;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default userReducer;\r\n","import produce from 'immer';\r\nimport { actionLoadDevices, actionNeedToLoad } from '../actions/actionTypes';\r\n\r\nconst defaultState = {\r\n  loaded: false,\r\n  devices: [],\r\n};\r\n\r\nconst deviceReducer = (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case actionLoadDevices:\r\n      return produce(state, (draft) => {\r\n        draft.devices = action.payload;\r\n        draft.loaded = true;\r\n      });\r\n    case actionNeedToLoad:\r\n      return produce(state, (draft) => {\r\n        draft.loaded = false;\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default deviceReducer;\r\n","import produce from 'immer';\r\nimport { actionLoadRules, actionNeedToLoad } from '../actions/actionTypes';\r\n\r\nconst defaultState = {\r\n  loaded: false,\r\n  rules: [],\r\n};\r\n\r\nconst ruleReducer = (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case actionLoadRules:\r\n      return produce(state, (draft) => {\r\n        draft.rules = action.payload;\r\n        draft.loaded = true;\r\n      });\r\n    case actionNeedToLoad:\r\n      return produce(state, (draft) => {\r\n        draft.loaded = false;\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default ruleReducer;\r\n","import produce from 'immer';\r\nimport { actionLoadStatistics } from '../actions/actionTypes';\r\n\r\nconst defaultState = {\r\n  devices: [],\r\n};\r\n\r\nconst statisticsReducer = (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case actionLoadStatistics:\r\n      return produce(state, (draft) => {\r\n        draft.devices = action.payload;\r\n      });\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default statisticsReducer;\r\n","import { combineReducers } from 'redux';\r\nimport userReducer from './userReducers';\r\nimport deviceReducer from './deviceReducers';\r\nimport ruleReducer from './ruleReducers';\r\nimport statisticsReducer from './statisticsReducers';\r\n\r\nconst rootReducer = combineReducers({\r\n  user: userReducer,\r\n  devices: deviceReducer,\r\n  rules: ruleReducer,\r\n  statistics: statisticsReducer,\r\n});\r\n\r\nexport default rootReducer;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport './custom.css';\nimport { Provider } from 'react-redux';\nimport { createStore } from 'redux';\nimport { CookiesProvider } from 'react-cookie';\nimport App from './App';\nimport rootReducer from './reducers';\n\nconst store = createStore(\n  rootReducer,\n  // eslint-disable-next-line no-underscore-dangle\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n);\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <CookiesProvider>\n        <App />\n      </CookiesProvider>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}